webpackJsonpCoveo__temporary([58],{298:function(o,t,n){"use strict";var e=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n])};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),r=n(9),s=n(39),l=n(12),p=n(2),c=n(10),u=n(1),a=n(4);n(589);var d=n(15),f=function(o){function t(n,e,i,l){var p=o.call(this,n,t.ID,i)||this;return p.element=n,p.options=e,p.bindings=i,p._window=l,p._window=p._window||window,p.options=r.ComponentOptions.initComponentOptions(n,t,e),p.bind.onRootElement(s.SettingsEvents.settingsPopulateMenu,function(o){o.menuData.push({text:c.l("ExportToExcel"),className:"coveo-export-to-excel",tooltip:c.l("ExportToExcelDescription"),onOpen:function(){return p.download()},svgIcon:d.SVGIcons.icons.dropdownExport,svgIconClassName:"coveo-export-to-excel-svg"})}),p}return e(t,o),t.prototype.download=function(){var o=this.queryController.getLastQuery();if(o){o=u.omit(o,"numberOfResults"),this.options.fieldsToInclude&&(o.fieldsToInclude=this.options.fieldsToInclude),this.logger.debug("Performing query following 'Export to Excel' click");var t=this.queryController.getEndpoint();this.usageAnalytics.logCustomEvent(l.analyticsActionCauseList.exportToExcel,{},this.element),this._window.location.replace(t.getExportToExcelLink(o,this.options.numberOfResults))}},t.create=function(o,n,e){return new t(o,n,e)},t}(i.Component);f.ID="ExportToExcel",f.doExport=function(){a.exportGlobally({ExportToExcel:f})},f.options={numberOfResults:r.ComponentOptions.buildNumberOption({defaultValue:100,min:1}),fieldsToInclude:r.ComponentOptions.buildFieldsOption()},t.ExportToExcel=f,p.Initialization.registerAutoCreateComponent(f)},589:function(o,t){}});