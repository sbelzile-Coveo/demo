{"version":3,"sources":["webpack:///./~/coveomagicbox/bin/MagicBox.min.js?52c3","webpack:///./src/ui/Querybox/QueryboxQueryParameters.ts?2ba3","webpack:///./sass/_Omnibox.scss?764b","webpack:///./src/ui/Omnibox/FieldAddon.ts?e792","webpack:///./src/ui/Omnibox/OldOmniboxAddon.ts?0e5e","webpack:///./src/ui/Omnibox/QueryExtensionAddon.ts?ffad","webpack:///./src/ui/Omnibox/QuerySuggestAddon.ts?2d1c","webpack:///./src/ui/Omnibox/Omnibox.ts?a863","webpack:///./src/ui/Querybox/Querybox.ts?c246"],"names":[],"mappings":"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","file":"Omnibox.js","sourcesContent":["var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e,n){var s=this;this.expression=e,this.input=n,_.isString(t)?this.value=t:_.isArray(t)&&(this.subResults=t,_.forEach(this.subResults,function(t){t.parent=s}))}return e.prototype.isSuccess=function(){return null!=this.value||null!=this.subResults&&_.all(this.subResults,function(t){return t.isSuccess()})},e.prototype.path=function(t){var e=null!=this.parent&&this.parent!=t?this.parent.path(t):[];return e.push(this),e},e.prototype.findParent=function(t){for(var e=this,n=_.isString(t)?function(e){return t==e.expression.id}:t;null!=e&&!n(e);)e=e.parent;return e},e.prototype.find=function(t){var e=_.isString(t)?function(e){return t==e.expression.id}:t;if(e(this))return this;if(this.subResults)for(var n=0;n<this.subResults.length;n++){var s=this.subResults[n].find(e);if(s)return s}return null},e.prototype.findAll=function(t){var e=[],n=_.isString(t)?function(e){return t==e.expression.id}:t;return n(this)&&e.push(this),this.subResults&&(e=_.reduce(this.subResults,function(t,e){return t.concat(e.findAll(n))},e)),e},e.prototype.resultAt=function(t,e){if(t<0||t>this.getLength())return[];if(null!=e){if(_.isString(e)){if(e==this.expression.id)return[this]}else if(e(this))return[this]}else{var n=null==this.value&&null==this.subResults?this.input:this.value;if(null!=n)return[this]}if(null!=this.subResults){for(var s=[],i=0;i<this.subResults.length;i++){var o=this.subResults[i];if(s=s.concat(o.resultAt(t,e)),t-=o.getLength(),t<0)break}return s}return[]},e.prototype.getExpect=function(){return null==this.value&&null==this.subResults?[this]:null!=this.subResults?_.reduce(this.subResults,function(t,e){return t.concat(e.getExpect())},[]):[]},e.prototype.getBestExpect=function(){var t=this.getExpect(),e=_.groupBy(t,function(t){return t.input}),n=_.last(_.keys(e).sort(function(t,e){return e.length-t.length})),s=e[n],e=_.groupBy(s,function(t){return t.expression.id});return _.map(e,function(t){return _.chain(t).map(function(t){return{path:t.path().length,result:t}}).sortBy(\"path\").pluck(\"result\").first().value()})},e.prototype.getHumanReadableExpect=function(){var t=this.getBestExpect(),e=t.length>0?_.last(t).input:\"\";return\"Expected \"+_.map(t,function(t){return t.getHumanReadable()}).join(\" or \")+\" but \"+(e.length>0?JSON.stringify(e[0]):\"end of input\")+\" found.\"},e.prototype.before=function(){if(null==this.parent)return\"\";var t=_.indexOf(this.parent.subResults,this);return this.parent.before()+_.chain(this.parent.subResults).first(t).map(function(t){return t.toString()}).join(\"\").value()},e.prototype.after=function(){if(null==this.parent)return\"\";var t=_.indexOf(this.parent.subResults,this);return _.chain(this.parent.subResults).last(this.parent.subResults.length-t-1).map(function(t){return t.toString()}).join(\"\").value()+this.parent.after()},e.prototype.getLength=function(){return null!=this.value?this.value.length:null!=this.subResults?_.reduce(this.subResults,function(t,e){return t+e.getLength()},0):this.input.length},e.prototype.toHtmlElement=function(){var t=document.createElement(\"span\"),e=null!=this.expression?this.expression.id:null;return null!=e&&t.setAttribute(\"data-id\",e),t.setAttribute(\"data-success\",this.isSuccess().toString()),null!=this.value?(t.appendChild(document.createTextNode(this.value)),t.setAttribute(\"data-value\",this.value)):null!=this.subResults?_.each(this.subResults,function(e){t.appendChild(e.toHtmlElement())}):(t.appendChild(document.createTextNode(this.input)),t.setAttribute(\"data-input\",this.input),t.className=\"magic-box-error\"+(this.input.length>0?\"\":\" magic-box-error-empty\")),t.result=this,t},e.prototype.clean=function(t){if(null!=t||!this.isSuccess()){t=t||_.last(this.getBestExpect()).path(this);var n=_.first(t);if(null!=n){var s=_.indexOf(this.subResults,n),i=s==-1?[]:_.map(_.first(this.subResults,s),function(t){return t.clean()});return i.push(n.clean(_.rest(t))),new e(i,this.expression,this.input)}return new e(null,this.expression,this.input)}return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(_.map(this.subResults,function(t){return t.clean()}),this.expression,this.input):void 0},e.prototype.clone=function(){return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(_.map(this.subResults,function(t){return t.clone()}),this.expression,this.input):new e(null,this.expression,this.input)},e.prototype.toString=function(){return null!=this.value?this.value:null!=this.subResults?_.map(this.subResults,function(t){return t.toString()}).join(\"\"):this.input},e.prototype.getHumanReadable=function(){return this.expression instanceof t.ExpressionConstant?JSON.stringify(this.expression.value):this.expression.id},e}();t.Result=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(e){function n(n){e.call(this,[n],t.ExpressionEndOfInput,n.input);var s=new t.Result(null,t.ExpressionEndOfInput,n.input.substr(n.getLength()));s.parent=this,this.subResults.push(s)}return __extends(n,e),n}(t.Result);t.EndOfInputResult=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(e){function n(t,n,s,i){var o=this;e.call(this,null!=t?[t]:null,n,s),this.result=t,this.expression=n,this.input=s,this.failAttempt=i,_.forEach(this.failAttempt,function(t){t.parent=o})}return __extends(n,e),n.prototype.getExpect=function(){var t=this,e=[];return null!=this.result&&(e=this.result.getExpect()),e=_.reduce(this.failAttempt,function(t,e){return t.concat(e.getExpect())},e),e.length>0&&_.all(e,function(e){return e.input==t.input})?[this]:e},n.prototype.clean=function(e){if(null!=e||!this.isSuccess()){e=_.rest(e||_.last(this.getBestExpect()).path(this));var n=_.first(e);return null==n?new t.Result(null,this.expression,this.input):new t.Result([n.clean(_.rest(e))],this.expression,this.input)}return new t.Result(_.map(this.result.subResults,function(t){return t.clean()}),this.expression,this.input)},n}(t.Result);t.OptionResult=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(e){function n(t,n,s,i){e.call(this,t,n,s),this.results=t,this.expression=n,this.input=s,_.last(t)!=i&&(this.failAttempt=i,null!=this.failAttempt&&(this.failAttempt.parent=this))}return __extends(n,e),n.prototype.getExpect=function(){var t=e.prototype.getExpect.call(this);return null!=this.failAttempt?t.concat(this.failAttempt.getExpect()):t},n.prototype.clean=function(n){if(null!=this.failAttempt&&(null!=n||!this.isSuccess())){n=n||_.last(this.getBestExpect()).path(this);var s=_.first(n);if(null!=s&&s==this.failAttempt){var i=_.last(this.subResults),o=_.map(null!=i&&i.isSuccess()?this.subResults:_.initial(this.subResults),function(t){return t.clean()});return o.push(s.clean(_.rest(n))),new t.Result(o,this.expression,this.input)}}return e.prototype.clean.call(this,n)},n}(t.Result);t.RefResult=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var s=0==e.indexOf(this.value),i=new t.Result(s?this.value:null,this,e);return s&&n&&e.length>this.value.length?new t.EndOfInputResult(i):i},e.prototype.toString=function(){return this.value},e}();t.ExpressionConstant=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){t.ExpressionEndOfInput={id:\"end of input\",parse:null}}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function t(t,e,n){this.func=t,this.id=e,this.grammar=n}return t.prototype.parse=function(t,e){return this.func(t,e,this)},t.prototype.toString=function(){return this.id},t}();t.ExpressionFunction=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e){if(this.parts=t,this.id=e,0==t.length)throw JSON.stringify(e)+\" should have at least 1 parts\"}return e.prototype.parse=function(e,n){for(var s,i=[],o=e,r=0;r<this.parts.length;r++){var u=this.parts[r];if(s=u.parse(o,n&&r==this.parts.length-1),i.push(s),!s.isSuccess())break;o=o.substr(s.getLength())}return new t.Result(i,this,e)},e.prototype.toString=function(){return this.id},e}();t.ExpressionList=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e){this.parts=t,this.id=e}return e.prototype.parse=function(e,n){for(var s=[],i=0;i<this.parts.length;i++){var o=this.parts[i].parse(e,n);if(o.isSuccess())return new t.OptionResult(o,this,e,s);s.push(o)}return new t.OptionResult(null,this,e,s)},e.prototype.toString=function(){return this.id},e}();t.ExpressionOptions=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e,n,s){this.ref=t,this.occurrence=e,this.id=n,this.grammar=s}return e.prototype.parse=function(t,e){var n=this.grammar.getExpression(this.ref);if(null==n)throw\"Expression not found:\"+this.ref;return\"?\"==this.occurrence||null==this.occurrence?this.parseOnce(t,e,n):this.parseMany(t,e,n)},e.prototype.parseOnce=function(e,n,s){var i=s.parse(e,n),o=i.isSuccess();return o||\"?\"!=this.occurrence?new t.RefResult([i],this,e,o?null:i):n?0==e.length?new t.RefResult([],this,e,i):_.all(i.getBestExpect(),function(e){return e.expression==t.ExpressionEndOfInput})?new t.RefResult([new t.Result(null,t.ExpressionEndOfInput,e)],this,e,i):i:new t.RefResult([],this,e,null)},e.prototype.parseMany=function(e,n,s){var i,o,r=[],u=e;do i=s.parse(u,!1),o=i.isSuccess(),o&&(r.push(i),u=u.substr(i.getLength()));while(o&&i.input!=u);var a=_.isNumber(this.occurrence)?this.occurrence:\"+\"==this.occurrence?1:0;if(r.length<a)r.push(i);else if(n)if(r.length>0){var l=_.last(r);i=s.parse(l.input,!0),i.isSuccess()?r[r.length-1]=i:(r.push(new t.Result(null,t.ExpressionEndOfInput,l.input.substr(l.getLength()))),i=s.parse(l.input.substr(l.getLength()),!0))}else if(0!=e.length){var p=new t.Result(null,t.ExpressionEndOfInput,e);return new t.RefResult([p],this,e,i)}return new t.RefResult(r,this,e,i)},e.prototype.toString=function(){return this.id},e}();t.ExpressionRef=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(t,e,n){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var s=e.match(this.value);null!=s&&0!=s.index&&(s=null);var i=new t.Result(null!=s?s[0]:null,this,e);return i.isSuccess()&&n&&e.length>i.value.length?new t.EndOfInputResult(i):i},e.prototype.toString=function(){return this.id},e}();t.ExpressionRegExp=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(e,n){void 0===n&&(n={}),this.expressions={},this.start=new t.ExpressionRef(e,null,\"start\",this),this.addExpressions(n)}return e.prototype.addExpressions=function(t){var e=this;_.each(t,function(t,n){e.addExpression(n,t)})},e.prototype.addExpression=function(t,n){if(t in this.expressions)throw\"Grammar already contain the id:\"+t;this.expressions[t]=e.buildExpression(n,t,this)},e.prototype.getExpression=function(t){return this.expressions[t]},e.prototype.parse=function(t){return this.start.parse(t,!0)},e.buildExpression=function(e,n,s){var i=typeof e;if(\"undefined\"==i)throw\"Invalid Expression: \"+e;if(_.isString(e))return this.buildStringExpression(e,n,s);if(_.isArray(e))return new t.ExpressionOptions(_.map(e,function(e,i){return new t.ExpressionRef(e,null,n+\"_\"+i,s)}),n);if(_.isRegExp(e))return new t.ExpressionRegExp(e,n,s);if(_.isFunction(e))return new t.ExpressionFunction(e,n,s);throw\"Invalid Expression: \"+e},e.buildStringExpression=function(n,s,i){var o=e.stringMatch(n,e.spliter),r=_.map(o,function(e,n){if(e[1]){var o=e[1],r=e[3]?Number(e[3]):e[2]||null;return new t.ExpressionRef(o,r,s+\"_\"+n,i)}return new t.ExpressionConstant(e[4],s+\"_\"+n)});if(1==r.length){var u=r[0];return u.id=s,u}return new t.ExpressionList(r,s)},e.stringMatch=function(t,e){for(var n,s=[],i=new RegExp(e.source,\"g\");null!==(n=i.exec(t));)s.push(n);return s},e.spliter=/\\[(\\w+)(\\*|\\+|\\?|\\{([1-9][0-9]*)\\})?\\]|(.[^\\[]*)/,e}();t.Grammar=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(e,n,s){this.element=e,this.onchange=n,this.magicBox=s,this.hasFocus=!1,this.justPressedTab=!1,this.underlay=document.createElement(\"div\"),this.underlay.className=\"magic-box-underlay\",this.highlightContainer=document.createElement(\"span\"),this.highlightContainer.className=\"magic-box-highlight-container\",this.underlay.appendChild(this.highlightContainer),this.ghostTextContainer=document.createElement(\"span\"),this.ghostTextContainer.className=\"magic-box-ghost-text\",this.underlay.appendChild(this.ghostTextContainer),this.input=t.$$(e).find(\"input\"),this.input?e.insertBefore(this.underlay,this.input):(this.input=document.createElement(\"input\"),e.appendChild(this.underlay),e.appendChild(this.input)),this.input.spellcheck=!1,this.input.setAttribute(\"form\",\"coveo-dummy-form\"),this.input.setAttribute(\"autocomplete\",\"off\"),this.setupHandler()}return e.prototype.updateInput=function(){this.input.value!=this.result.input&&(this.input.value=this.result.input,this.hasFocus&&this.setCursor(this.getValue().length))},e.prototype.updateHighlight=function(){this.highlightContainer.innerHTML=\"\",this.highlightContainer.appendChild(this.result.toHtmlElement())},e.prototype.updateWordCompletion=function(){this.ghostTextContainer.innerHTML=\"\",null!=this.wordCompletion&&this.ghostTextContainer.appendChild(document.createTextNode(this.wordCompletion.substr(this.result.input.length)))},e.prototype.updateScroll=function(e){var n=this;void 0===e&&(e=!0);var s=function(){n.underlay.clientWidth<n.underlay.scrollWidth&&(n.underlay.style.visibility=\"hidden\",n.underlay.scrollLeft=n.input.scrollLeft,n.underlay.scrollTop=n.input.scrollTop,n.underlay.style.visibility=\"visible\"),n.updateScrollDefer=null,n.hasFocus&&n.updateScroll()};e?null==this.updateScrollDefer&&(this.updateScrollDefer=t.requestAnimationFrame(s)):s()},e.prototype.setResult=function(t,e){this.result=t,this.updateInput(),this.updateHighlight(),_.isUndefined(e)&&null!=this.wordCompletion&&0==this.wordCompletion.indexOf(this.result.input)?this.updateWordCompletion():this.setWordCompletion(e),this.updateScroll()},e.prototype.setWordCompletion=function(t){null!=t&&0!=t.toLowerCase().indexOf(this.result.input.toLowerCase())&&(t=null),this.wordCompletion=t,this.updateWordCompletion(),this.updateScroll()},e.prototype.setCursor=function(t){if(this.input.focus(),this.input.createTextRange){var e=this.input.createTextRange();e.move(\"character\",t),e.select()}else null!=this.input.selectionStart&&(this.input.focus(),this.input.setSelectionRange(t,t))},e.prototype.getCursor=function(){return this.input.selectionStart},e.prototype.setupHandler=function(){var t=this;this.input.onblur=function(){t.hasFocus=!1,setTimeout(function(){t.hasFocus||t.onblur&&t.onblur()},300),t.updateScroll()},this.input.onfocus=function(){t.hasFocus||(t.hasFocus=!0,t.updateScroll(),t.onfocus&&t.onfocus())},this.input.onkeydown=function(e){t.keydown(e)},this.input.onkeyup=function(e){t.keyup(e)},this.input.onclick=function(){t.onchangecursor()},this.input.oncut=function(){setTimeout(function(){t.onInputChange()})},this.input.onpaste=function(){setTimeout(function(){t.onInputChange()})}},e.prototype.focus=function(){var t=this;this.hasFocus=!0,setTimeout(function(){t.input.focus(),t.setCursor(t.getValue().length)})},e.prototype.blur=function(){this.hasFocus&&this.input.blur()},e.prototype.keydown=function(e){var n=this;switch(e.keyCode||e.which){case 9:this.justPressedTab?this.blur():this.magicBox.hasSuggestions()&&e.preventDefault(),this.justPressedTab=!0;break;default:e.stopPropagation(),this.justPressedTab=!1,null==this.onkeydown||this.onkeydown(e.keyCode||e.which)?t.requestAnimationFrame(function(){n.onInputChange()}):e.preventDefault()}},e.prototype.keyup=function(t){switch(t.keyCode||t.which){case 9:this.tabPress();break;case 37:case 39:this.onchangecursor();break;default:null==this.onkeydown||this.onkeyup(t.keyCode||t.which)?this.onInputChange():t.preventDefault()}},e.prototype.tabPress=function(){null!=this.wordCompletion&&(this.input.value=this.wordCompletion),this.ontabpress&&this.ontabpress(),this.magicBox.showSuggestion()},e.prototype.onInputChange=function(){this.result.input!=this.input.value&&this.onchange(this.input.value,!1)},e.prototype.getValue=function(){return this.input.value},e.prototype.getWordCompletion=function(){return this.wordCompletion},e}();t.InputManager=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e=function(){function e(e,n){var s=this;this.element=e,this.options=_.defaults(n,{selectableClass:\"magic-box-suggestion\",selectedClass:\"magic-box-selected\"}),void 0==this.options.timeout&&(this.options.timeout=500),this.hasSuggestions=!1,t.$$(this.element).on(\"mouseover\",function(t){s.handleMouseOver(t)}),t.$$(this.element).on(\"mouseout\",function(t){s.handleMouseOut(t)})}return e.prototype.handleMouseOver=function(e){var n=t.$$(e.target),s=n.parents(this.options.selectableClass);n.hasClass(this.options.selectableClass)?this.addSelectedClass(n.el):s.length>0&&this.element.contains(s[0])&&this.addSelectedClass(s[0])},e.prototype.handleMouseOut=function(e){var n=t.$$(e.target),s=n.parents(this.options.selectableClass);if(e.relatedTarget){var i=t.$$(e.relatedTarget).parents(this.options.selectableClass);n.hasClass(this.options.selectedClass)&&!t.$$(e.relatedTarget).hasClass(this.options.selectableClass)?n.removeClass(this.options.selectedClass):0==i.length&&s.length>0&&t.$$(s[0]).removeClass(this.options.selectedClass)}else n.hasClass(this.options.selectedClass)?n.removeClass(this.options.selectedClass):s.length>0&&t.$$(s[0]).removeClass(this.options.selectedClass)},e.prototype.moveDown=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),s=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var i=0;i<n.length;i++)if(e==n.item(i)){s=i;break}s=s==-1?0:s+1}else s=0;return e=n.item(s),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},e.prototype.moveUp=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),s=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var i=0;i<n.length;i++)if(e==n.item(i)){s=i;break}s=s==-1?n.length-1:s-1}else s=n.length-1;return e=n.item(s),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},e.prototype.select=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0);return null!=e&&t.$$(e).trigger(\"keyboardSelect\"),e},e.prototype.mergeSuggestions=function(t,e){var n,s=this,i=[];t=_.compact(t);var o=this.pendingSuggestion=new Promise(function(e,r){_.each(t,function(t){var e=!1;setTimeout(function(){e=!0},s.options.timeout),t.then(function(t){!e&&t&&(i=i.concat(t))})});var u=function(){n&&clearTimeout(n),0==i.length?e([]):o==s.pendingSuggestion||null==s.pendingSuggestion?e(i.sort(function(t,e){return e.index-t.index})):r(\"new request queued\")};0==t.length&&u(),void 0==t&&u(),n=setTimeout(function(){u()},s.options.timeout),Promise.all(t).then(function(){return u()})});o.then(function(t){return e&&e(t),s.updateSuggestions(t),t})[\"catch\"](function(){return null})},e.prototype.updateSuggestions=function(e){var n=this;this.element.innerHTML=\"\",this.element.className=\"magic-box-suggestions\",_.each(e,function(e){var s=e.dom;if(s){t.$$(s).removeClass(n.options.selectedClass);var i=t.$$(s).find(\".\"+n.options.selectableClass);t.$$(i).removeClass(n.options.selectedClass)}else{if(s=document.createElement(\"div\"),s.className=\"magic-box-suggestion\",null!=e.html)s.innerHTML=e.html;else if(null!=e.text)s.appendChild(document.createTextNode(e.text));else if(null!=e.separator){s.className=\"magic-box-suggestion-seperator\";var o=document.createElement(\"div\");o.className=\"magic-box-suggestion-seperator-label\",o.appendChild(document.createTextNode(e.separator)),s.appendChild(o)}t.$$(s).on(\"click\",function(){e.onSelect()}),t.$$(s).on(\"keyboardSelect\",function(){e.onSelect()}),t.$$(s).addClass(n.options.selectableClass)}s.suggestion=e,n.element.appendChild(s)}),e.length>0?(t.$$(this.element).addClass(\"magic-box-hasSuggestion\"),this.hasSuggestions=!0):(t.$$(this.element).removeClass(\"magic-box-hasSuggestion\"),this.hasSuggestions=!1)},e.prototype.returnMoved=function(e){if(null!=e){if(e.suggestion)return e.suggestion;if(e[\"no-text-suggestion\"])return null;if(e instanceof HTMLElement)return{text:t.$$(e).text()}}return null},e.prototype.addSelectedClass=function(e){for(var n=this.element.getElementsByClassName(this.options.selectedClass),s=0;s<n.length;s++){var i=n.item(s);t.$$(i).removeClass(this.options.selectedClass)}t.$$(e).addClass(this.options.selectedClass)},e}();t.SuggestionsManager=e}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(e){function n(t){return t.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\"\\\\$&\")}function s(t,e,s,o,r){if(void 0===s&&(s=!1),void 0===o&&(o=\"magic-box-hightlight\"),void 0===r&&(r=\"\"),0==e.length)return t;var u=n(e),a=\"(\"+u+\")|(.*?(?=\"+u+\")|.+)\",l=new RegExp(a,s?\"gi\":\"g\");return t.replace(l,function(t,e,n){return i(null!=e?o:r,t)})}var i=function(t,e){return'<span class=\"'+t+'\">'+_.escape(e)+\"</span>\"};e.highlightText=s;var o=function(){function e(t){this.el=t}return e.prototype.text=function(t){return t?void(void 0!=this.el.innerText?this.el.innerText=t:void 0!=this.el.textContent&&(this.el.textContent=t)):this.el.innerText||this.el.textContent},e.prototype.nodeListToArray=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t.item(e);return n},e.prototype.empty=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},e.prototype.show=function(){this.el.style.display=\"visible\"},e.prototype.hide=function(){this.el.style.display=\"none\"},e.prototype.toggle=function(t){void 0===t?\"visible\"==this.el.style.display?this.hide():this.show():t?this.show():this.hide()},e.prototype.find=function(t){return this.el.querySelector(t)},e.prototype.is=function(t){return this.el.tagName.toLowerCase()==t.toLowerCase()||(!(\".\"!=t[0]||!this.hasClass(t.substr(1)))||\"#\"==t[0]&&this.el.getAttribute(\"id\")==t.substr(1))},e.prototype.closest=function(e){for(var n=this.el,s=!1;!s&&(t.$$(n).hasClass(e)&&(s=!0),\"body\"!=n.tagName.toLowerCase())&&null!=n.parentElement;)s||(n=n.parentElement);if(s)return n},e.prototype.parent=function(t){if(void 0!=this.el.parentElement)return this.traverseAncestorForClass(this.el.parentElement,t)},e.prototype.parents=function(t){for(var n=[],s=this.parent(t);s;)n.push(s),s=new e(s).parent(t);return n},e.prototype.findAll=function(t){return this.nodeListToArray(this.el.querySelectorAll(t))},e.prototype.findClass=function(t){return\"getElementsByClassName\"in this.el?this.nodeListToArray(this.el.getElementsByClassName(t)):this.nodeListToArray(this.el.querySelectorAll(\".\"+t))},e.prototype.findId=function(t){return document.getElementById(t)},e.prototype.addClass=function(t){this.hasClass(t)||(this.el.className?this.el.className+=\" \"+t:this.el.className=t)},e.prototype.removeClass=function(t){this.el.className=this.el.className.replace(new RegExp(\"(^|\\\\s)\"+t+\"(\\\\s|\\\\b)\",\"g\"),\"$1\")},e.prototype.toggleClass=function(t,e){e?this.addClass(t):this.removeClass(t)},e.prototype.getClass=function(){return this.el.className.match(e.CLASS_NAME_REGEX)||[]},e.prototype.hasClass=function(t){return _.contains(this.getClass(),t)},e.prototype.detach=function(){this.el.parentElement&&this.el.parentElement.removeChild(this.el)},e.prototype.on=function(t,n){var s=this;if(_.isArray(t))_.each(t,function(t){s.on(t,n)});else{var i=this.getJQuery();if(i)i(this.el).on(t,n);else if(this.el.addEventListener){var o=function(t){n(t,t.detail)};e.handlers.push({eventHandle:n,fn:o}),this.el.addEventListener(t,o,!1)}else this.el.on&&this.el.on(\"on\"+t,n)}},e.prototype.one=function(t,e){var n=this;if(_.isArray(t))_.each(t,function(t){n.one(t,e)});else{var s=function(i){return n.off(t,s),e(i)};this.on(t,s)}},e.prototype.off=function(t,n){var s=this;if(_.isArray(t))_.each(t,function(t){s.off(t,n)});else{var i=this.getJQuery();if(i)i(this.el).off(t,n);else if(this.el.removeEventListener){var o=0,r=_.find(e.handlers,function(t,e){if(t.eventHandle==n)return o=e,!0});r&&(this.el.removeEventListener(t,r.fn,!1),e.handlers.splice(o,1))}else this.el.off&&this.el.off(\"on\"+t,n)}},e.prototype.trigger=function(t,e){var n=this.getJQuery();if(n)n(this.el).trigger(t,e);else if(void 0!==CustomEvent){var s=new CustomEvent(t,{detail:e,bubbles:!0});this.el.dispatchEvent(s)}},e.prototype.isEmpty=function(){return e.ONLY_WHITE_SPACE_REGEX.test(this.el.innerHTML)},e.prototype.isDescendant=function(t){for(var e=this.el.parentNode;null!=e;){if(e==t)return!0;e=e.parentNode}return!1},e.prototype.traverseAncestorForClass=function(e,n){void 0===e&&(e=this.el),0==n.indexOf(\".\")&&(n=n.substr(1));for(var s=!1;!s&&(t.$$(e).hasClass(n)&&(s=!0),\"body\"!=e.tagName.toLowerCase())&&null!=e.parentElement;)s||(e=e.parentElement);if(s)return e},e.prototype.getJQuery=function(){return void 0!=window.jQuery&&window.jQuery},e.CLASS_NAME_REGEX=/-?[_a-zA-Z]+[_a-zA-Z0-9-]*/g,e.ONLY_WHITE_SPACE_REGEX=/^\\s*$/,e.handlers=[],e}();e.Dom=o}(e=t.Utils||(t.Utils={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){t.$$=function(e){return window.Coveo&&window.Coveo.$$?window.Coveo.$$(e):new t.Utils.Dom(e)}}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(e){function n(t,e,n,s){_.each(s.expressions,function(e){_.contains(t,e)||t.push(e)}),_.each(s.basicExpressions,function(t){_.contains(e,t)||e.push(t)}),_.each(s.grammars,function(t,e){if(e in n){if(!_.isArray(n[e])||!_.isArray(t))throw _.each(t,function(t){n[e].push(t)}),\"Can not merge \"+e+\"(\"+new String(t)+\" => \"+new String(n[e])+\")\";_.each(t,function(t){n[e].push(t)})}else n[e]=t})}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var s=[],i=[],o={Start:[\"Expressions\",\"Empty\"],Expressions:\"[OptionalSpaces][Expression][ExpressionsList*][OptionalSpaces]\",ExpressionsList:\"[Spaces][Expression]\",Expression:s,BasicExpression:i,OptionalSpaces:/ */,Spaces:/ +/,Empty:/(?!.)/},r=0;r<t.length;r++)n(s,i,o,t[r]),_.each(t[r].include,function(e){_.contains(t,e)||t.push(e)});return s.push(\"BasicExpression\"),{start:\"Start\",expressions:o}}function i(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i=s.apply(this,e);return new t.Grammar(i.start,i.expressions)}e.Expressions=s,e.ExpressionsGrammar=i}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(e){e.notWordStart=\" ()[],$@'\\\"\",e.notInWord=\" ()[],:\",e.Basic={basicExpressions:[\"Word\",\"DoubleQuoted\"],grammars:{DoubleQuoted:'\"[NotDoubleQuote]\"',NotDoubleQuote:/[^\"]*/,SingleQuoted:\"'[NotSingleQuote]'\",NotSingleQuote:/[^']*/,Number:/[0-9]+/,Word:function(n,s,i){var o=new RegExp(\"[^\"+e.notWordStart.replace(/(.)/g,\"\\\\$1\")+\"][^\"+e.notInWord.replace(/(.)/g,\"\\\\$1\")+\"]*\"),r=n.match(o);null!=r&&0!=r.index&&(r=null);var u=new t.Result(null!=r?r[0]:null,i,n);return u.isSuccess()&&s&&n.length>u.value.length?new t.EndOfInputResult(u):u}}}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.SubExpression={basicExpressions:[\"SubExpression\"],grammars:{SubExpression:\"([Expressions])\"}}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.Date={grammars:{Date:\"[DateYear]/[DateMonth]/[DateDay]\",DateYear:/([0-9]{4})/,DateMonth:/(1[0-2]|0?[1-9])/,DateDay:/([1-2][0-9]|3[0-1]|0?[1-9])/,DateRange:\"[Date][Spaces?]..[Spaces?][Date]\",DateRelative:[\"DateRelativeNegative\",\"DateRelativeTerm\"],DateRelativeTerm:/now|today|yesterday/,DateRelativeNegative:\"[DateRelativeTerm][DateRelativeNegativeRef]\",DateRelativeNegativeRef:/([\\-\\+][0-9]+(s|m|h|d|mo|y))/},include:[t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.Field={basicExpressions:[\"FieldSimpleQuery\",\"FieldQuery\",\"Field\"],grammars:{FieldQuery:\"[Field][OptionalSpaces][FieldQueryOperation]\",FieldQueryOperation:[\"FieldQueryValue\",\"FieldQueryNumeric\"],FieldQueryValue:\"[FieldOperator][OptionalSpaces][FieldValue]\",FieldQueryNumeric:\"[FieldOperatorNumeric][OptionalSpaces][FieldValueNumeric]\",FieldSimpleQuery:\"[FieldName]:[OptionalSpaces][FieldValue]\",Field:\"@[FieldName]\",FieldName:/[a-zA-Z][a-zA-Z0-9\\.\\_]*/,FieldOperator:/==|=|<>/,FieldOperatorNumeric:/<=|>=|<|>/,FieldValue:[\"DateRange\",\"NumberRange\",\"DateRelative\",\"Date\",\"Number\",\"FieldValueList\",\"FieldValueString\"],FieldValueNumeric:[\"DateRelative\",\"Date\",\"Number\"],FieldValueString:[\"DoubleQuoted\",\"FieldValueNotQuoted\"],FieldValueList:\"([FieldValueString][FieldValueStringList*])\",FieldValueStringList:\"[FieldValueSeparator][FieldValueString]\",FieldValueSeparator:/ *, */,FieldValueNotQuoted:/[^ \\(\\),]+/,NumberRange:\"[Number][Spaces?]..[Spaces?][Number]\"},include:[t.Date,t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.QueryExtension={basicExpressions:[\"QueryExtension\"],grammars:{QueryExtension:\"$[QueryExtensionName]([QueryExtensionArguments])\",QueryExtensionName:/\\w+/,QueryExtensionArguments:\"[QueryExtensionArgumentList*][QueryExtensionArgument]\",QueryExtensionArgumentList:\"[QueryExtensionArgument][Spaces?],[Spaces?]\",QueryExtensionArgument:\"[QueryExtensionArgumentName]:[Spaces?][QueryExtensionArgumentValue]\",QueryExtensionArgumentName:/\\w+/,QueryExtensionArgumentValue:[\"SingleQuoted\",\"Expressions\"]},include:[t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.NestedQuery={basicExpressions:[\"NestedQuery\"],grammars:{NestedQuery:\"[[NestedField][OptionalSpaces][Expressions]]\",NestedField:\"[[Field]]\",FieldValue:[\"NestedQuery\"]},include:[t.Field]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){var e;!function(t){t.Complete={include:[t.NestedQuery,t.QueryExtension,t.SubExpression,t.Field,t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));var Coveo;!function(t){var e;!function(t){function e(t,e,n){return new s(t,e,n)}function n(t){return\"requestAnimationFrame\"in window?window.requestAnimationFrame(t):setTimeout(t)}var s=function(){function e(e,n,s){var i=this;void 0===s&&(s={}),this.element=e,this.grammar=n,this.options=s,this.lastSuggestions=[],_.isUndefined(this.options.inline)&&(this.options.inline=!1),t.$$(e).addClass(\"magic-box\"),this.options.inline&&t.$$(e).addClass(\"magic-box-inline\"),this.result=this.grammar.parse(\"\"),this.displayedResult=this.result.clean(),this.clearDom=document.createElement(\"div\"),this.clearDom.className=\"magic-box-clear\";var o=document.createElement(\"div\");o.className=\"magic-box-icon\",this.clearDom.appendChild(o);var r=t.$$(e).find(\".magic-box-input\");r?e.insertBefore(this.clearDom,r):(r=document.createElement(\"div\"),\nr.className=\"magic-box-input\",e.appendChild(this.clearDom),e.appendChild(r)),this.inputManager=new t.InputManager(r,function(t,e){e?(i.setText(t),i.onselect&&i.onselect(i.getFirstSuggestionText())):(i.setText(t),i.showSuggestion(),i.onchange&&i.onchange())},this),this.inputManager.ontabpress=function(){i.ontabpress&&i.ontabpress()};var u=this.inputManager.getValue();u&&(this.displayedResult.input=u),this.inputManager.setResult(this.displayedResult);var a=document.createElement(\"div\");a.className=\"magic-box-suggestions\",this.element.appendChild(a),this.suggestionsManager=new t.SuggestionsManager(a,{selectableClass:this.options.selectableSuggestionClass,selectedClass:this.options.selectedSuggestionClass,timeout:this.options.suggestionTimeout}),this.setupHandler()}return e.prototype.getResult=function(){return this.result},e.prototype.getDisplayedResult=function(){return this.displayedResult},e.prototype.setText=function(e){t.$$(this.element).toggleClass(\"magic-box-notEmpty\",e.length>0),this.result=this.grammar.parse(e),this.displayedResult=this.result.clean(),this.inputManager.setResult(this.displayedResult)},e.prototype.setCursor=function(t){this.inputManager.setCursor(t)},e.prototype.getCursor=function(){return this.inputManager.getCursor()},e.prototype.resultAtCursor=function(t){return this.displayedResult.resultAt(this.getCursor(),t)},e.prototype.setupHandler=function(){var e=this;this.inputManager.onblur=function(){t.$$(e.element).removeClass(\"magic-box-hasFocus\"),e.onblur&&e.onblur(),e.options.inline||e.clearSuggestion()},this.inputManager.onfocus=function(){t.$$(e.element).addClass(\"magic-box-hasFocus\"),e.showSuggestion(),e.onfocus&&e.onfocus()},this.inputManager.onkeydown=function(t){if(38==t||40==t)return!1;if(13==t){var n=e.suggestionsManager.select();return null==n&&e.onsubmit&&e.onsubmit(),!1}return 27==t&&(e.clearSuggestion(),e.blur()),!0},this.inputManager.onchangecursor=function(){e.showSuggestion()},this.inputManager.onkeyup=function(t){if(38==t)e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveUp()),e.onchange&&e.onchange();else{if(40!=t)return!0;e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveDown()),e.onchange&&e.onchange()}return!1},this.clearDom.onclick=function(){e.clear()}},e.prototype.showSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions(null!=this.getSuggestions?this.getSuggestions():[],function(e){t.updateSuggestion(e)})},e.prototype.updateSuggestion=function(t){var e=this;this.lastSuggestions=t;var n=this.getFirstSuggestionText();this.inputManager.setWordCompletion(n&&n.text),this.onsuggestions&&this.onsuggestions(t),_.each(t,function(t){null==t.onSelect&&null!=t.text&&(t.onSelect=function(){e.setText(t.text),e.onselect&&e.onselect(t)})})},e.prototype.focus=function(){t.$$(this.element).addClass(\"magic-box-hasFocus\"),this.inputManager.focus()},e.prototype.blur=function(){this.inputManager.blur()},e.prototype.clearSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions([],function(e){t.updateSuggestion(e)}),this.inputManager.setWordCompletion(null)},e.prototype.focusOnSuggestion=function(t){null==t||null==t.text?(t=this.getFirstSuggestionText(),this.inputManager.setResult(this.displayedResult,t&&t.text)):this.inputManager.setResult(this.grammar.parse(t.text).clean(),t.text)},e.prototype.getFirstSuggestionText=function(){return _.find(this.lastSuggestions,function(t){return null!=t.text})},e.prototype.getText=function(){return this.inputManager.getValue()},e.prototype.getWordCompletion=function(){return this.inputManager.getWordCompletion()},e.prototype.clear=function(){this.setText(\"\"),this.showSuggestion(),this.focus(),this.onclear&&this.onclear()},e.prototype.hasSuggestions=function(){return this.suggestionsManager.hasSuggestions},e}();t.Instance=s,t.create=e,t.requestAnimationFrame=n}(e=t.MagicBox||(t.MagicBox={}))}(Coveo||(Coveo={}));\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = Coveo.MagicBox;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/exports-loader?Coveo.MagicBox!./~/coveomagicbox/bin/MagicBox.min.js\n// module id = 429\n// module chunks = 7 9 37 70","import { IQueryboxOptions } from './Querybox';\nimport { QueryBuilder } from '../Base/QueryBuilder';\nimport * as _ from 'underscore';\n\nexport class QueryboxQueryParameters {\n  constructor(private options: IQueryboxOptions) {\n  }\n\n  public addParameters(queryBuilder: QueryBuilder, lastQuery: string) {\n    if (this.options.enableWildcards) {\n      queryBuilder.enableWildcards = true;\n    }\n\n    if (this.options.enableQuestionMarks) {\n      queryBuilder.enableQuestionMarks = true;\n    }\n\n    if (this.options.enableLowercaseOperators) {\n      queryBuilder.enableLowercaseOperators = true;\n    }\n\n    if (!_.isEmpty(lastQuery)) {\n      queryBuilder.enableQuerySyntax = this.options.enableQuerySyntax;\n      queryBuilder.expression.add(lastQuery);\n      if (this.options.enablePartialMatch) {\n        queryBuilder.enablePartialMatch = this.options.enablePartialMatch;\n        if (this.options.partialMatchKeywords) {\n          queryBuilder.partialMatchKeywords = this.options.partialMatchKeywords;\n        }\n        if (this.options.partialMatchThreshold) {\n          queryBuilder.partialMatchThreshold = this.options.partialMatchThreshold;\n        }\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Querybox/QueryboxQueryParameters.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_Omnibox.scss\n// module id = 490\n// module chunks = 7 9 70","///<reference path='Omnibox.ts'/>\nimport { Omnibox, IPopulateOmniboxSuggestionsEventArgs, IOmniboxSuggestion, MagicBox } from './Omnibox';\nimport { OmniboxEvents } from '../../events/OmniboxEvents';\nimport { IFieldDescription } from '../../rest/FieldDescription';\nimport { IEndpointError } from '../../rest/EndpointError';\nimport * as _ from 'underscore';\n\ninterface IFieldAddonHash {\n  type: string;\n  before: string;\n  after: string;\n  current: string;\n  field?: string;\n}\n\nexport class FieldAddon {\n  static INDEX = 64;\n\n  cache: { [hash: string]: Promise<string[]> } = {};\n\n  constructor(public omnibox: Omnibox) {\n    this.omnibox.bind.on(this.omnibox.element, OmniboxEvents.populateOmniboxSuggestions, (args: IPopulateOmniboxSuggestionsEventArgs) => {\n      args.suggestions.push(this.getSuggestion());\n    });\n  }\n\n  public getSuggestion(): Promise<IOmniboxSuggestion[]> {\n    var hash = this.getHash();\n    if (hash == null) {\n      return null;\n    }\n    var hashString = this.hashToString(hash);\n    if (this.cache[hashString] != null) {\n      return this.hashValueToSuggestion(hash, this.cache[hashString]);\n    }\n    var values: Promise<IOmniboxSuggestion[]>;\n    if (hash.type == 'FieldName') {\n      values = this.fieldNames(hash.current);\n    }\n    if (hash.type == 'FieldValue') {\n      values = this.fieldValues(hash.field, hash.current);\n    }\n    if (hash.type == 'SimpleFieldName') {\n      values = this.simpleFieldNames(hash.current);\n    }\n    this.cache[hashString] = values;\n    values.catch(() => {\n      delete this.cache[hashString];\n    });\n    return this.hashValueToSuggestion(hash, values);\n  }\n\n  private getHash(): IFieldAddonHash {\n    var fieldName: Coveo.MagicBox.Result = _.last(this.omnibox.resultAtCursor('FieldName'));\n    if (fieldName != null) {\n      fieldName = fieldName.findParent('Field') || fieldName;\n      var currentField = fieldName.toString();\n      var before = fieldName.before();\n      var after = fieldName.after();\n      return { type: 'FieldName', current: currentField, before: before, after: after };\n    }\n    var fieldValue: Coveo.MagicBox.Result = _.last(this.omnibox.resultAtCursor('FieldValue'));\n    if (fieldValue) {\n      var fieldQuery = fieldValue.findParent('FieldQuery') || (this.omnibox.options.enableSimpleFieldAddon && fieldValue.findParent('FieldSimpleQuery'));\n      if (fieldQuery) {\n        var field = fieldQuery.find('FieldName').toString();\n        if (this.omnibox.options.fieldAlias) {\n          if (field in this.omnibox.options.fieldAlias) {\n            field = this.omnibox.options.fieldAlias[field];\n          }\n        }\n        var value = fieldValue.toString();\n        var before = fieldValue.before();\n        var after = fieldValue.after();\n        return { type: 'FieldValue', field: field, current: value, before: before, after: after };\n      }\n    }\n    if (this.omnibox.options.enableSimpleFieldAddon) {\n      var word: Coveo.MagicBox.Result = _.last(this.omnibox.resultAtCursor('Word'));\n      if (word != null) {\n        var currentField = word.toString();\n        var before = word.before();\n        var after = word.after();\n        return { type: 'SimpleFieldName', current: currentField, before: before, after: after };\n      }\n    }\n  }\n\n  private hashToString(hash: IFieldAddonHash) {\n    if (hash == null) {\n      return null;\n    }\n    return hash.type + hash.current + (hash.field || '');\n  }\n\n  private hashValueToSuggestion(hash: IFieldAddonHash, promise: Promise<string[]>): Promise<IOmniboxSuggestion[]> {\n    return promise.then((values) => {\n      var suggestions: IOmniboxSuggestion[] = _.map(values, (value: string, i) => {\n        return {\n          text: hash.before + (hash.current.toLowerCase().indexOf(value.toLowerCase()) == 0 ? hash.current + value.substr(hash.current.length) : value) + hash.after,\n          html: MagicBox.Utils.highlightText(value, hash.current, true),\n          index: FieldAddon.INDEX - i / values.length\n        };\n      });\n      return suggestions;\n    });\n  }\n\n  private fields: Promise<string[]>;\n\n  private getFields(): Promise<string[]> {\n    if (this.fields == null) {\n      this.fields = new Promise<string[]>((resolve, reject) => {\n        if (this.omnibox.options.listOfFields != null) {\n          resolve(<string[]>this.omnibox.options.listOfFields);\n        } else {\n          var promise: Promise<IFieldDescription[] | IEndpointError> = this.omnibox.queryController.getEndpoint().listFields();\n          promise.then((fieldDescriptions: IFieldDescription[]) => {\n            var fieldNames = _.chain(fieldDescriptions)\n              .filter((fieldDescription: IFieldDescription) => fieldDescription.includeInQuery && fieldDescription.groupByField)\n              .map((fieldDescription: IFieldDescription) => fieldDescription.name.substr(1))\n              .value();\n\n            resolve(fieldNames);\n          }).catch(() => {\n            reject();\n          });\n        }\n      });\n    }\n    return this.fields;\n  }\n\n  private fieldNames(current: string): Promise<IOmniboxSuggestion[]> {\n    var withAt = current.length > 0 && current[0] == '@';\n    var fieldName = withAt ? current.substr(1) : current;\n    var fieldNameLC = fieldName.toLowerCase();\n\n    return this.getFields().then((fields: string[]) => {\n      var matchFields = _.chain(fields)\n        .map((field: string) => {\n          return {\n            index: field.toLowerCase().indexOf(fieldNameLC),\n            field: withAt ? field : '@' + field\n          };\n        })\n        .filter((field) => {\n          return field.index != -1 && field.field.length > current.length;\n        })\n        .sortBy('index')\n        .map((field) => field.field)\n        .value();\n      matchFields = _.first(matchFields, 5);\n      return matchFields;\n    });\n  }\n\n  private fieldValues(field: string, current: string): Promise<IOmniboxSuggestion[]> {\n    return this.omnibox.queryController.getEndpoint().listFieldValues({\n      pattern: '.*' + current + '.*',\n      patternType: 'RegularExpression',\n      sortCriteria: 'occurrences',\n      field: '@' + field,\n      maximumNumberOfValues: 5\n    }).then((values) => {\n      return _.chain(values)\n        .map((value) => {\n          return {\n            index: value.value.toLowerCase().indexOf(current),\n            value: value.value\n          };\n        })\n        .filter((value) => {\n          return value.value.length > current.length;\n        })\n        .sortBy('index')\n        .map((value) => {\n          return value.value.replace(/ /g, '\\u00A0');\n        })\n        .value();\n    });\n  }\n\n  private simpleFieldNames(current: string): Promise<IOmniboxSuggestion[]> {\n    var fieldName = current;\n    var fieldNameLC = fieldName.toLowerCase();\n\n    return this.getFields().then((fields: string[]) => {\n      var matchFields = _.chain(fields)\n        .map((field: string) => {\n          return {\n            index: field.toLowerCase().indexOf(fieldNameLC),\n            field: field + ':'\n          };\n        })\n        .filter((field) => {\n          return field.index != -1 && field.field.length > current.length;\n        })\n        .sortBy('index')\n        .map((field) => field.field)\n        .value();\n      matchFields = _.first(matchFields, 5);\n      return matchFields;\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Omnibox/FieldAddon.ts","///<reference path=\"Omnibox.ts\"/>\nimport { Omnibox, IPopulateOmniboxSuggestionsEventArgs, IOmniboxSuggestion } from './Omnibox';\nimport { IOmniboxDataRow } from './OmniboxInterface';\nimport { OmniboxEvents, IPopulateOmniboxEventArgs, IPopulateOmniboxEventRow } from '../../events/OmniboxEvents';\nimport { $$ } from '../../utils/Dom';\nimport { Utils } from '../../utils/Utils';\nimport * as _ from 'underscore';\n\nexport class OldOmniboxAddon {\n  constructor(public omnibox: Omnibox) {\n    this.omnibox.bind.on(this.omnibox.element, OmniboxEvents.populateOmniboxSuggestions, (args: IPopulateOmniboxSuggestionsEventArgs) => {\n      _.each(this.getSuggestion(), (suggestion) => {\n        args.suggestions.push(suggestion);\n      });\n    });\n  }\n\n  private lastQuery: string;\n  private lastSuggestions: Promise<IOmniboxSuggestion[]>[];\n\n  public getSuggestion(): Promise<IOmniboxSuggestion[]>[] {\n    let text = this.omnibox.magicBox.getText();\n\n    if (text.length == 0) {\n      return null;\n    }\n\n    if (this.lastQuery == text) {\n      return this.lastSuggestions;\n    }\n\n    this.lastQuery = text;\n\n    let eventArgs = this.buildPopulateOmniboxEventArgs();\n    $$(this.omnibox.root).trigger(OmniboxEvents.populateOmnibox, eventArgs);\n\n    return this.lastSuggestions = this.rowsToSuggestions(eventArgs.rows);\n  }\n\n  private getCurrentQueryExpression() {\n    let cursorPos = this.omnibox.getCursor();\n    let value = this.omnibox.getText();\n    let length = value.length;\n    let start = cursorPos;\n    let end = cursorPos;\n    if (value[start] == ' ') {\n      start--;\n    }\n    while (start > 0 && value[start] != ' ') {\n      start--;\n    }\n    while (end < length && value[end] != ' ') {\n      end++;\n    }\n    return value.substring(start, end);\n  }\n\n  private getRegexToSearch(strValue?: string) {\n    if (strValue == null) {\n      strValue = this.omnibox.getText();\n    }\n    return new RegExp(Utils.escapeRegexCharacter(strValue), 'i');\n  }\n\n  private getQueryExpressionBreakDown() {\n    let ret = [];\n    let queryWords = this.omnibox.getText().split(' ');\n    _.each(queryWords, (word) => {\n      ret.push({\n        word: word,\n        regex: this.getRegexToSearch(word)\n      });\n    });\n    return ret;\n  }\n\n  private replace(searchValue: string, newValue: string) {\n    this.omnibox.setText(this.omnibox.getText().replace(searchValue, newValue));\n  }\n\n  private clearCurrentExpression() {\n    this.replace(this.getCurrentQueryExpression(), '');\n  }\n\n  private insertAt(at: number, toInsert: string) {\n    let oldValue = this.omnibox.getText();\n    let newValue = [oldValue.slice(0, at), toInsert, oldValue.slice(at)].join('');\n    this.omnibox.setText(newValue);\n  }\n\n  private replaceCurrentExpression(newValue: string) {\n    this.replace(this.getCurrentQueryExpression(), newValue);\n  }\n\n  private buildPopulateOmniboxEventArgs() {\n    let currentQueryExpression = this.getCurrentQueryExpression();\n    let ret: IPopulateOmniboxEventArgs = {\n      rows: [],\n      completeQueryExpression: {\n        word: this.omnibox.getText(),\n        regex: this.getRegexToSearch()\n      },\n      currentQueryExpression: {\n        word: currentQueryExpression,\n        regex: this.getRegexToSearch(currentQueryExpression)\n      },\n      allQueryExpressions: this.getQueryExpressionBreakDown(),\n      cursorPosition: this.omnibox.getCursor(),\n      clear: () => {\n        this.omnibox.clear();\n      },\n      clearCurrentExpression: () => {\n        this.clearCurrentExpression();\n      },\n      replace: (searchValue: string, newValue: string) => {\n        this.replace(searchValue, newValue);\n      },\n      replaceCurrentExpression: (newValue: string) => {\n        this.replaceCurrentExpression(newValue);\n      },\n      insertAt: (at: number, toInsert: string) => {\n        this.insertAt(at, toInsert);\n      },\n      closeOmnibox: () => {\n        this.omnibox.magicBox.blur();\n      }\n    };\n    return ret;\n  }\n\n  private rowsToSuggestions(rows: IOmniboxDataRow[]): Promise<IOmniboxSuggestion[]>[] {\n    return _.map(rows, (row: IPopulateOmniboxEventRow) => {\n      if (!Utils.isNullOrUndefined(row.element)) {\n        return new Promise<IOmniboxSuggestion[]>((resolve) => {\n          resolve([{\n            dom: row.element,\n            index: row.zIndex\n          }]);\n        });\n      } else if (!Utils.isNullOrUndefined(row.deferred)) {\n        return new Promise<IOmniboxSuggestion[]>((resolve) => {\n          row.deferred.then((row) => {\n            if (row.element != null) {\n              resolve([{\n                dom: row.element,\n                index: row.zIndex\n              }]);\n            } else {\n              resolve(null);\n            }\n          });\n        });\n      }\n      return null;\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Omnibox/OldOmniboxAddon.ts","///<reference path='Omnibox.ts'/>\nimport { OmniboxEvents } from '../../events/OmniboxEvents';\nimport { Omnibox, IPopulateOmniboxSuggestionsEventArgs, IOmniboxSuggestion, MagicBox } from './Omnibox';\nimport { IExtension } from '../../rest/Extension';\nimport * as _ from 'underscore';\n\ninterface IQueryExtensionAddonHash {\n  type: string;\n  before: string;\n  after: string;\n  current: string;\n  name?: string;\n  used?: string[];\n}\n\nexport class QueryExtensionAddon {\n  static INDEX = 62;\n\n  cache: { [hash: string]: Promise<string[]> } = {};\n\n  constructor(public omnibox: Omnibox) {\n    this.omnibox.bind.on(this.omnibox.element, OmniboxEvents.populateOmniboxSuggestions, (args: IPopulateOmniboxSuggestionsEventArgs) => {\n      args.suggestions.push(this.getSuggestion());\n    });\n  }\n\n  public getSuggestion(): Promise<IOmniboxSuggestion[]> {\n    var hash = this.getHash(this.omnibox.magicBox);\n    if (hash == null) {\n      return null;\n    }\n    var hashString = this.hashToString(hash);\n    if (this.cache[hashString] != null) {\n      return this.hashValueToSuggestion(hash, this.cache[hashString]);\n    }\n    var values = (hash.type == 'QueryExtensionName' ? this.names(hash.current) : this.attributeNames(hash.name, hash.current, hash.used));\n    this.cache[hashString] = values;\n    values.catch(() => {\n      delete this.cache[hashString];\n    });\n    return this.hashValueToSuggestion(hash, values);\n  }\n\n  private getHash(magicBox: Coveo.MagicBox.Instance): IQueryExtensionAddonHash {\n    var queryExtension: Coveo.MagicBox.Result = _.last(magicBox.resultAtCursor('QueryExtension'));\n    if (queryExtension != null) {\n      var queryExtensionArgumentResults = queryExtension.findAll('QueryExtensionArgument');\n      var current = _.last(magicBox.resultAtCursor('QueryExtensionName'));\n      if (current != null) {\n        return {\n          type: 'QueryExtensionName',\n          current: current.toString(),\n          before: current.before(),\n          after: current.after()\n        };\n      }\n\n      current = _.last(magicBox.resultAtCursor('QueryExtensionArgumentName'));\n      if (current != null) {\n\n        var used: string[] = _.chain(queryExtensionArgumentResults)\n          .map((result) => {\n            var name = result.find('QueryExtensionArgumentName');\n            return name && name.toString();\n          })\n          .compact()\n          .value();\n\n        var name = queryExtension.find('QueryExtensionName').toString();\n\n        return {\n          type: 'QueryExtensionArgumentName',\n          current: current.toString(),\n          before: current.before(),\n          after: current.after(),\n          name: name,\n          used: used\n        };\n      }\n    }\n    return null;\n  }\n\n  private hashToString(hash: IQueryExtensionAddonHash) {\n    if (hash == null) {\n      return null;\n    }\n    return [hash.type, hash.current, (hash.name || ''), (hash.used ? hash.used.join() : '')].join();\n  }\n\n  private hashValueToSuggestion(hash: IQueryExtensionAddonHash, promise: Promise<string[]>): Promise<IOmniboxSuggestion[]> {\n    return promise.then((values) => {\n      var suggestions: IOmniboxSuggestion[] = _.map(values, (value, i) => {\n        return {\n          html: MagicBox.Utils.highlightText(value, hash.current, true),\n          text: hash.before + value + hash.after,\n          index: QueryExtensionAddon.INDEX - i / values.length\n        };\n      });\n      return suggestions;\n    });\n  }\n\n  private extensions: Promise<any>;\n\n  private getExtensions() {\n    if (this.extensions == null) {\n      this.extensions = this.omnibox.queryController.getEndpoint().extensions();\n    }\n    return this.extensions;\n  }\n\n  private names(current: string): Promise<string[]> {\n    var extensionName = current.toLowerCase();\n    return this.getExtensions().then((extensions: IExtension[]) => {\n      var matchExtensions = _.chain(extensions)\n        .map((extension: IExtension) => {\n          return {\n            index: extension.name.toLowerCase().indexOf(extensionName),\n            extension: extension.name\n          };\n        })\n        .filter((extension) => {\n          return extension.index != -1 && extension.extension.length > extensionName.length;\n        })\n        .sortBy('index')\n        .pluck('extension')\n        .value();\n      matchExtensions = _.first(matchExtensions, 5);\n      return matchExtensions;\n    });\n  }\n\n  private attributeNames(name: string, current: string, used: string[]): Promise<string[]> {\n    return this.getExtensions().then((extensions: IExtension[]) => {\n      var extension = _.find(extensions, (extension: IExtension) => extension.name == name);\n      if (extension == null) {\n        return [];\n      } else {\n        return _.filter(_.difference(extension.argumentNames, used), (argumentName: string) => argumentName.indexOf(current) == 0);\n      }\n    });\n  }\n\n  public hash() {\n    return;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Omnibox/QueryExtensionAddon.ts","///<reference path=\"Omnibox.ts\"/>\nimport { Omnibox, IPopulateOmniboxSuggestionsEventArgs, IOmniboxSuggestion } from './Omnibox';\nimport { $$, Dom } from '../../utils/Dom';\nimport { IQuerySuggestCompletion, IQuerySuggestRequest, IQuerySuggestResponse } from '../../rest/QuerySuggest';\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\nimport { OmniboxEvents } from '../../events/OmniboxEvents';\nimport { StringUtils } from '../../utils/StringUtils';\nimport * as _ from 'underscore';\n\nexport class QuerySuggestAddon {\n\n  static INDEX = 60;\n\n  private static suggestiontHtml(suggestion: IQuerySuggestCompletion) {\n    return suggestion.highlighted.replace(/\\[(.*?)\\]|\\{(.*?)\\}|\\((.*?)\\)/g, (part, notMatched, matched, corrected) => {\n      var className = '';\n      if (matched) {\n        className = 'coveo-omnibox-hightlight';\n      }\n      if (corrected) {\n        className = 'coveo-omnibox-hightlight2';\n      }\n\n      let ret: Dom;\n      if (className) {\n        ret = $$('span', {\n          className: className\n        });\n      } else {\n        ret = $$('span');\n      }\n      ret.text(notMatched || matched || corrected);\n      return ret.el.outerHTML;\n    });\n  }\n\n  private static isPartialMatch(suggestion: IQuerySuggestCompletion) {\n    // groups : 1=notMatched, 2=matched, 3=corrected\n    var parts = StringUtils.match(suggestion.highlighted, /\\[(.*?)\\]|\\{(.*?)\\}|\\((.*?)\\)/g);\n    var firstFail = _.find(parts, (part: string[]) => part[1] != null);\n    // if no fail found, this is a partial or a full match\n    if (firstFail == null) {\n      return true;\n    }\n    // if all right parts are notMatched, the right parts is autocomplete\n    return _.every(_.last(parts, _.indexOf(parts, firstFail) - parts.length), (part: string[]) => part[1] != null);\n  }\n\n  private cache: { [hash: string]: Promise<IOmniboxSuggestion[]> } = {};\n\n  constructor(public omnibox: Omnibox) {\n    $$(this.omnibox.element).on(OmniboxEvents.populateOmniboxSuggestions, (e: Event, args: IPopulateOmniboxSuggestionsEventArgs) => {\n      args.suggestions.push(this.getSuggestion());\n    });\n  }\n\n  public getSuggestion(): Promise<IOmniboxSuggestion[]> {\n\n    var text = this.omnibox.magicBox.getText();\n\n    if (text.length == 0) {\n      return null;\n    }\n\n    if (this.cache[text] != null) {\n      return this.cache[text];\n    }\n\n    let promise = this.getQuerySuggest(text);\n    this.cache[text] = promise;\n    promise.catch(() => {\n      delete this.cache[text];\n    });\n    return this.cache[text];\n  }\n\n  private getQuerySuggest(text: string): Promise<IOmniboxSuggestion[]> {\n    let payload = <IQuerySuggestRequest>{ q: text };\n    let language = <string>String['locale'];\n    let searchHub = this.omnibox.getBindings().componentOptionsModel.get(ComponentOptionsModel.attributesEnum.searchHub);\n    let pipeline = this.omnibox.getBindings().searchInterface.options.pipeline;\n    let enableWordCompletion = this.omnibox.options.enableSearchAsYouType;\n    let context = this.omnibox.getBindings().queryController.getLastQuery().context;\n\n    if (language) {\n      payload.language = language;\n    }\n\n    if (searchHub) {\n      payload.searchHub = searchHub;\n    }\n\n    if (pipeline) {\n      payload.pipeline = pipeline;\n    }\n\n    if (context) {\n      payload.context = context;\n    }\n\n    payload.enableWordCompletion = enableWordCompletion;\n\n    return this.omnibox.queryController.getEndpoint()\n      .getQuerySuggest(payload)\n      .then((result: IQuerySuggestResponse) => {\n        var completions = result.completions;\n        var results: IOmniboxSuggestion[] = _.map(completions, (completion, i) => {\n          return {\n            html: QuerySuggestAddon.suggestiontHtml(completion),\n            text: completion.expression,\n            index: QuerySuggestAddon.INDEX - i / completions.length,\n            partial: QuerySuggestAddon.isPartialMatch(completion),\n            executableConfidence: completion.executableConfidence\n          };\n        });\n        return results;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Omnibox/QuerySuggestAddon.ts","///<reference path=\"FieldAddon.ts\" />\n///<reference path=\"QueryExtensionAddon.ts\" />\n///<reference path=\"QuerySuggestAddon.ts\" />\n///<reference path=\"OldOmniboxAddon.ts\" />\n\nimport { ComponentOptionsModel, COMPONENT_OPTIONS_ATTRIBUTES } from '../../models/ComponentOptionsModel';\nexport const MagicBox: any = require('exports-loader?Coveo.MagicBox!../../../node_modules/coveomagicbox/bin/MagicBox.min.js');\nimport { IQueryboxOptions } from '../Querybox/Querybox';\nimport { Component } from '../Base/Component';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { ComponentOptions, IFieldOption } from '../Base/ComponentOptions';\nimport { QueryEvents, IBuildingQueryEventArgs } from '../../events/QueryEvents';\nimport { StandaloneSearchInterfaceEvents } from '../../events/StandaloneSearchInterfaceEvents';\nimport { MODEL_EVENTS, IAttributeChangedEventArg } from '../../models/Model';\nimport { QUERY_STATE_ATTRIBUTES } from '../../models/QueryStateModel';\nimport { IAnalyticsNoMeta, analyticsActionCauseList, IAnalyticsOmniboxSuggestionMeta } from '../Analytics/AnalyticsActionListMeta';\nimport { OmniboxEvents, IOmniboxPreprocessResultForQueryEventArgs } from '../../events/OmniboxEvents';\nimport { $$ } from '../../utils/Dom';\nimport { Assert } from '../../misc/Assert';\nimport { QueryStateModel } from '../../models/QueryStateModel';\nimport { Initialization } from '../Base/Initialization';\nimport { Querybox } from '../Querybox/Querybox';\nimport { FieldAddon } from './FieldAddon';\nimport { QueryExtensionAddon } from './QueryExtensionAddon';\nimport { QuerySuggestAddon } from './QuerySuggestAddon';\nimport { OldOmniboxAddon } from './OldOmniboxAddon';\nimport { QueryboxQueryParameters } from '../Querybox/QueryboxQueryParameters';\nimport { IAnalyticsActionCause } from '../Analytics/AnalyticsActionListMeta';\nimport { IDuringQueryEventArgs } from '../../events/QueryEvents';\nimport { PendingSearchAsYouTypeSearchEvent } from '../Analytics/PendingSearchAsYouTypeSearchEvent';\nimport { Utils } from '../../utils/Utils';\nimport { StandaloneSearchInterface } from '../SearchInterface/SearchInterface';\nimport * as _ from 'underscore';\nimport { exportGlobally } from '../../GlobalExports';\nimport 'styling/_Omnibox';\nimport { InitializationEvents } from '../../events/InitializationEvents';\n\nexport interface IPopulateOmniboxSuggestionsEventArgs {\n  omnibox: Omnibox;\n  suggestions: Array<Coveo.MagicBox.Suggestion[] | Promise<Coveo.MagicBox.Suggestion[]>>;\n}\n\nexport interface IOmniboxSuggestion extends Coveo.MagicBox.Suggestion {\n  executableConfidence?: number;\n}\n\nexport interface IOmniboxOptions extends IQueryboxOptions {\n  inline?: boolean;\n  enableFieldAddon?: boolean;\n  enableSimpleFieldAddon?: boolean;\n  listOfFields?: IFieldOption[];\n  fieldAlias?: { [alias: string]: IFieldOption };\n  enableQuerySuggestAddon?: boolean;\n  enableQueryExtensionAddon?: boolean;\n  omniboxTimeout?: number;\n  placeholder?: string;\n  grammar?: (grammar: { start: string; expressions: { [id: string]: Coveo.MagicBox.ExpressionDef }; }) => { start: string; expressions: { [id: string]: Coveo.MagicBox.ExpressionDef } };\n}\n\nconst MINIMUM_EXECUTABLE_CONFIDENCE = 0.8;\n\n/**\n * The Omnibox component is very similar to the simpler {@link Querybox} component. It supports all of the same options\n * and behaviors.\n *\n * The Omnibox component takes care of adding type-ahead capability to the search input. Custom components can extend\n * and customize the type-ahead and the suggestions it provides.\n *\n * The type-ahead is configurable by activating addons, which the Coveo JavaScript Search Framework provides OOTB\n * (facets, analytics suggestions, Coveo Machine Learning suggestions and advanced Coveo syntax suggestions).\n *\n * It is also possible for external code to provide type-ahead suggestions.\n *\n * See also the {@link Searchbox} component, which can automatically instantiate an Omnibox component along with an\n * optional {@link SearchButton} component.\n */\nexport class Omnibox extends Component {\n  public static ID = 'Omnibox';\n\n  static doExport = () => {\n    exportGlobally({\n      'Omnibox': Omnibox,\n      'MagicBox': MagicBox\n    });\n  }\n\n  /**\n   * The options for the omnibox\n   * @componentOptions\n   */\n  static options: IOmniboxOptions = {\n\n    /**\n     * Specifies whether suggestions appearing in the Omnibox should push the result down instead of appearing over the\n     * results.\n     *\n     * Set this option as well as {@link Omnibox.options.enableSearchAsYouType} and\n     * {@link Omnibox.options.enableQuerySuggestAddon} to `true` for a cool effect!\n     *\n     * Default value is `false`.\n     */\n    inline: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether to automatically trigger a new query whenever the end user types new text inside the Omnibox.\n     *\n     * Set this option as well a {@link Omnibox.options.inline} and\n     * {@link Omnibox.options.enableQuerySuggestAddon} to `true` for a cool effect!\n     *\n     * Default value is `false`.\n     */\n    enableSearchAsYouType: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * If {@link Omnibox.options.enableSearchAsYouType} is `true`, specifies the delay (in milliseconds) before\n     * triggering a new query when the user types new text inside the Omnibox.\n     *\n     * Default value is `2000`. Minimum value is `0`.\n     */\n    searchAsYouTypeDelay: ComponentOptions.buildNumberOption({\n      defaultValue: 2000,\n      min: 0,\n      depend: 'enableSearchAsYouType'\n    }),\n\n    /**\n     * If {@link Querybox.options.enableQuerySyntax} is `true`, specifies whether to enable the `field` addon.\n     *\n     * The `field` addon allows the search box to highlight and complete field syntax.\n     *\n     * **Example:**\n     *\n     * > Suppose you want to filter on a certain file type. You start typing `@sysf` in the input. The Omnibox provides\n     * > you with several matching fields. You select the `@sysfiletype` suggestion and type `=`. If this option is set\n     * > to `true`, then the Omnibox provides you with suggestions for available matching file types.\n     *\n     * Default value is `false`.\n     */\n    enableFieldAddon: ComponentOptions.buildBooleanOption({\n      defaultValue: false,\n      depend: 'enableQuerySyntax',\n      postProcessing: (value, options: IOmniboxOptions) => {\n        if (value) {\n          options.enableQuerySyntax = true;\n        }\n        return value;\n      }\n    }),\n    enableSimpleFieldAddon: ComponentOptions.buildBooleanOption({ defaultValue: false, depend: 'enableFieldAddon' }),\n    listOfFields: ComponentOptions.buildFieldsOption({ depend: 'enableFieldAddon' }),\n\n    /**\n     * Specifies whether to enable the Coveo Machine Learning (Coveo ML) query suggestions.\n     *\n     * This implies that you have a proper Coveo ML integration configured (see\n     * [Managing Machine Learning Query Suggestions in a Query Pipeline](http://www.coveo.com/go?dest=cloudhelp&lcid=9&context=168)).\n     *\n     * Default value is `true`.\n     */\n    enableQuerySuggestAddon: ComponentOptions.buildBooleanOption({\n      defaultValue: true,\n      alias: ['enableTopQueryAddon', 'enableRevealQuerySuggestAddon']\n    }),\n\n    /**\n     * If {@link Querybox.options.enableQuerySyntax} is `true`, specifies whether to enable the `query extension` addon.\n     *\n     * The `query extension` addon allows the Omnibox to complete the syntax for query extensions.\n     *\n     * Default value is `false`.\n     */\n    enableQueryExtensionAddon: ComponentOptions.buildBooleanOption({\n      defaultValue: false,\n      depend: 'enableQuerySyntax',\n      postProcessing: (value, options: IOmniboxOptions) => {\n        if (value) {\n          options.enableQuerySyntax = true;\n        }\n        return value;\n      }\n    }),\n\n    /**\n     * Specifies a placeholder for the input.\n     */\n    placeholder: ComponentOptions.buildLocalizedStringOption(),\n\n    /**\n     * Specifies a timeout (in milliseconds) before rejecting suggestions in the Omnibox.\n     *\n     * Default value is `2000`. Minimum value is `0`.\n     */\n    omniboxTimeout: ComponentOptions.buildNumberOption({ defaultValue: 2000, min: 0 }),\n    /**\n     * Specifies whether the Coveo Platform should try to interpret special query syntax such as field references in the\n     * query that the user enters in the Querybox (see\n     * [Coveo Query Syntax Reference](http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10005)).\n     *\n     * Setting this option to `true` also causes the query syntax in the Querybox to highlight.\n     *\n     * Default value is `false`.\n     */\n    enableQuerySyntax: ComponentOptions.buildBooleanOption({\n      defaultValue: false\n    }),\n  };\n\n  public magicBox: Coveo.MagicBox.Instance;\n  private partialQueries: string[] = [];\n  private lastSuggestions: IOmniboxSuggestion[] = [];\n  private lastQuery: string;\n  private modifyEventTo: IAnalyticsActionCause;\n  private movedOnce = false;\n  private searchAsYouTypeTimeout: number;\n  private skipAutoSuggest = false;\n\n  /**\n   * Creates a new Omnibox component. Also enables necessary addons and binds events on various query events.\n   * @param element The HTMLElement on which to instantiate the component.\n   * @param options The options for the Omnibox component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time).\n   */\n  constructor(public element: HTMLElement, public options?: IOmniboxOptions, bindings?: IComponentBindings) {\n    super(element, Omnibox.ID, bindings);\n\n    this.options = ComponentOptions.initComponentOptions(element, Omnibox, options);\n\n    const originalValueForQuerySyntax = this.options.enableQuerySyntax;\n    this.options = _.extend({}, this.options, this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.searchBox));\n\n    if (this.options.enableQuerySuggestAddon) {\n      new QuerySuggestAddon(this);\n    }\n    new OldOmniboxAddon(this);\n    this.createMagicBox();\n\n    this.bind.onRootElement(QueryEvents.buildingQuery, (args: IBuildingQueryEventArgs) => this.handleBuildingQuery(args));\n    this.bind.onRootElement(StandaloneSearchInterfaceEvents.beforeRedirect, () => this.handleBeforeRedirect());\n    this.bind.onRootElement(QueryEvents.querySuccess, () => this.handleQuerySuccess());\n    this.bind.onQueryState(MODEL_EVENTS.CHANGE_ONE, QUERY_STATE_ATTRIBUTES.Q, (args: IAttributeChangedEventArg) => this.handleQueryStateChanged(args));\n    if (this.isAutoSuggestion()) {\n      this.bind.onRootElement(QueryEvents.duringQuery, (args: IDuringQueryEventArgs) => this.handleDuringQuery(args));\n    }\n    this.bind.onComponentOptions(MODEL_EVENTS.CHANGE_ONE, COMPONENT_OPTIONS_ATTRIBUTES.SEARCH_BOX, (args: IAttributeChangedEventArg) => {\n      if (args.value.enableQuerySyntax != null) {\n        this.options.enableQuerySyntax = args.value.enableQuerySyntax;\n      } else {\n        this.options.enableQuerySyntax = originalValueForQuerySyntax;\n      }\n      this.updateGrammar();\n    });\n  }\n\n  /**\n   * Adds the current content of the input to the query and triggers a query if the current content of the input has\n   * changed since last submit.\n   *\n   * Also logs a `searchboxSubmit` event in the usage analytics.\n   */\n  public submit() {\n    this.magicBox.clearSuggestion();\n    this.updateQueryState();\n    this.triggerNewQuery(false, () => {\n      this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxSubmit, {});\n    });\n  }\n\n  /**\n   * Gets the current content of the input.\n   * @returns {string} The current content of the input.\n   */\n  public getText() {\n    return this.magicBox.getText();\n  }\n\n  /**\n   * Sets the content of the input\n   * @param text The string to set in the input.\n   */\n  public setText(text: string) {\n    this.magicBox.setText(text);\n    this.updateQueryState();\n  }\n\n  /**\n   * Clears the content of the input.\n   */\n  public clear() {\n    this.magicBox.clear();\n  }\n\n  /**\n   * Gets the `HTMLInputElement` of the Omnibox.\n   */\n  public getInput() {\n    return <HTMLInputElement>this.magicBox.element.querySelector('input');\n  }\n\n  public getResult() {\n    return this.magicBox.getResult();\n  }\n\n  public getDisplayedResult() {\n    return this.magicBox.getDisplayedResult();\n  }\n\n  public getCursor() {\n    return this.magicBox.getCursor();\n  }\n\n  public resultAtCursor(match?: string | { (result: Coveo.MagicBox.Result): boolean; }) {\n    return this.magicBox.resultAtCursor(match);\n  }\n\n  private createGrammar() {\n    let grammar = null;\n\n    if (this.options.enableQuerySyntax) {\n      grammar = MagicBox.Grammars.Expressions(MagicBox.Grammars.Complete);\n      if (this.options.enableFieldAddon) {\n        new FieldAddon(this);\n      }\n      if (this.options.fieldAlias != null) {\n        this.options.listOfFields = this.options.listOfFields || [];\n        this.options.listOfFields = this.options.listOfFields.concat(_.keys(this.options.fieldAlias));\n      }\n      if (this.options.enableQueryExtensionAddon) {\n        new QueryExtensionAddon(this);\n      }\n    } else {\n      grammar = { start: 'Any', expressions: { Any: /.*/ } };\n    }\n\n    if (this.options.grammar != null) {\n      grammar = this.options.grammar(grammar);\n    }\n\n    return grammar;\n  }\n\n  private updateGrammar() {\n    const grammar = this.createGrammar();\n    this.magicBox.grammar = new MagicBox.Grammar(grammar.start, grammar.expressions);\n    this.magicBox.setText(this.magicBox.getText());\n  }\n\n  private createMagicBox() {\n    const grammar = this.createGrammar();\n    this.magicBox = MagicBox.create(this.element, new MagicBox.Grammar(grammar.start, grammar.expressions), {\n      inline: this.options.inline,\n      selectableSuggestionClass: 'coveo-omnibox-selectable',\n      selectedSuggestionClass: 'coveo-omnibox-selected',\n      suggestionTimeout: this.options.omniboxTimeout\n    });\n    this.setupMagicBox();\n  }\n\n  private setupMagicBox() {\n    this.magicBox.onmove = () => {\n      // We assume that once the user has moved its selection, it becomes an explicit omnibox analytics event\n      if (this.isAutoSuggestion()) {\n        this.modifyEventTo = this.getOmniboxAnalyticsEventCause();\n      }\n      this.movedOnce = true;\n    };\n\n    this.magicBox.onfocus = () => {\n      if (this.isAutoSuggestion()) {\n        // This flag is used to block the automatic query when the UI is loaded with a query (#q=foo)\n        // and then the input is focused. We want to block that query, even if it match the suggestion\n        // Only when there is an actual change in the input (user typing something) is when we want the automatic query to kick in\n        this.skipAutoSuggest = true;\n      }\n    };\n\n    this.magicBox.onsuggestions = (suggestions: IOmniboxSuggestion[]) => {\n      // If text is empty, this can mean that user selected text from the search box\n      // and hit \"delete\" : Reset the partial queries in this case\n      if (Utils.isEmptyString(this.getText())) {\n        this.partialQueries = [];\n      }\n      this.movedOnce = false;\n      this.lastSuggestions = suggestions;\n      if (this.isAutoSuggestion() && !this.skipAutoSuggest) {\n        this.searchAsYouType();\n      }\n    };\n\n    if (this.options.enableSearchAsYouType) {\n      $$(this.element).addClass('coveo-magicbox-search-as-you-type');\n    }\n\n    this.magicBox.onchange = () => {\n      this.skipAutoSuggest = false;\n      let text = this.getText();\n      if (text != undefined && text != '') {\n        if (this.isAutoSuggestion()) {\n          if (this.movedOnce) {\n            this.searchAsYouType(true);\n          }\n        } else if (this.options.enableSearchAsYouType) {\n          this.searchAsYouType(true);\n        }\n      } else {\n        this.clear();\n      }\n\n    };\n\n    if (this.options.placeholder) {\n      (<HTMLInputElement>this.magicBox.element.querySelector('input')).placeholder = this.options.placeholder;\n    }\n    this.magicBox.onsubmit = () => {\n      this.magicBox.clearSuggestion();\n      this.updateQueryState();\n      this.triggerNewQuery(false, () => {\n        this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxSubmit, {});\n      });\n      this.magicBox.blur();\n    };\n\n    this.magicBox.onselect = (suggestion: IOmniboxSuggestion) => {\n      let index = _.indexOf(this.lastSuggestions, suggestion);\n      let suggestions = _.compact(_.map(this.lastSuggestions, (suggestion) => suggestion.text));\n      this.magicBox.clearSuggestion();\n      this.updateQueryState();\n      // A bit tricky here : When it's machine learning auto suggestions\n      // the mouse selection and keyboard selection acts differently :\n      // keyboard selection will automatically do the query (which will log a search as you type event -> further modified by this.modifyEventTo if needed)\n      // mouse selection will not \"auto\" send the query.\n      // the movedOnce variable detect the keyboard movement, and is used to differentiate mouse vs keyboard\n      if (!this.isAutoSuggestion()) {\n        this.usageAnalytics.cancelAllPendingEvents();\n        this.triggerNewQuery(false, () => {\n          this.usageAnalytics.logSearchEvent<IAnalyticsOmniboxSuggestionMeta>(this.getOmniboxAnalyticsEventCause(), this.buildCustomDataForPartialQueries(index, suggestions));\n        });\n      } else if (this.isAutoSuggestion() && this.movedOnce) {\n        this.handleAutoSuggestionWithKeyboard(index, suggestions);\n      } else if (this.isAutoSuggestion() && !this.movedOnce) {\n        this.handleAutoSuggestionsWithMouse(index, suggestions);\n      }\n\n      // Consider a selection like a reset of the partial queries (it's the end of a suggestion pattern)\n      if (this.isAutoSuggestion()) {\n        this.partialQueries = [];\n      }\n    };\n\n    this.magicBox.onblur = () => {\n      if (this.options.enableSearchAsYouType && !this.options.inline) {\n        this.setText(this.lastQuery);\n      } else {\n        this.updateQueryState();\n      }\n      if (this.isAutoSuggestion()) {\n        this.usageAnalytics.sendAllPendingEvents();\n      }\n    };\n\n    this.magicBox.onclear = () => {\n      this.updateQueryState();\n      if (this.options.triggerQueryOnClear) {\n        this.triggerNewQuery(false, () => {\n          this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxClear, {});\n        });\n      }\n    };\n\n    this.magicBox.ontabpress = () => {\n      this.handleTabPress();\n    };\n\n\n    this.magicBox.getSuggestions = () => this.handleSuggestions();\n  }\n\n  private handleAutoSuggestionWithKeyboard(index: number, suggestions: string[]) {\n    if (this.searchAsYouTypeTimeout) {\n      // Here, there is currently a search as you typed queued up :\n      // Think : user typed very quickly, then very quickly selected a suggestion (without waiting for the search as you type)\n      // Cancel the search as you type query, then immediately do the query with the selection (+analytics event with the selection)\n      this.usageAnalytics.cancelAllPendingEvents();\n      clearTimeout(this.searchAsYouTypeTimeout);\n      this.searchAsYouTypeTimeout = undefined;\n      this.triggerNewQuery(false, () => {\n        this.usageAnalytics.logSearchEvent<IAnalyticsOmniboxSuggestionMeta>(this.getOmniboxAnalyticsEventCause(), this.buildCustomDataForPartialQueries(index, suggestions));\n      });\n\n    } else {\n      // Here, the search as you type query has returned, but the analytics event has not ye been sent.\n      // Think : user typed slowly, the query returned, and then the user selected a suggestion.\n      // Since the analytics event has not yet been sent (search as you type event have a 5 sec delay)\n      // modify the pending event, then send the newly modified analytics event immediately.\n      this.modifyEventTo = this.getOmniboxAnalyticsEventCause();\n      this.modifyCustomDataOnPending(index, suggestions);\n      this.usageAnalytics.sendAllPendingEvents();\n    }\n  }\n\n  private handleAutoSuggestionsWithMouse(index: number, suggestions: string[]) {\n    if (this.searchAsYouTypeTimeout || index != 0) {\n      // Here : the user either very quickly chose the first suggestion, and the search as you type is still queued up.\n      // OR\n      // the user chose something different then the first suggestion.\n      // Remove the search as you type if it's there, and do the query with the suggestion directly.\n      this.clearSearchAsYouType();\n      this.usageAnalytics.cancelAllPendingEvents();\n      this.triggerNewQuery(false, () => {\n        this.usageAnalytics.logSearchEvent<IAnalyticsOmniboxSuggestionMeta>(this.getOmniboxAnalyticsEventCause(), this.buildCustomDataForPartialQueries(index, suggestions));\n      });\n\n    } else {\n      // Here : the user either very slowly chose a suggestion, and there is no search as you typed queued up\n      // AND\n      // the user chose the first suggestion.\n      // this means the query is already returned, but the analytics event is still queued up.\n      // modify the analytics event, and send it.\n      this.modifyEventTo = this.getOmniboxAnalyticsEventCause();\n      this.modifyCustomDataOnPending(index, suggestions);\n      this.usageAnalytics.sendAllPendingEvents();\n\n      // This should happen if :\n      // users did a (short) query first, which does not match the first suggestion. (eg: typed \"t\", then search)\n      // then, refocus the search box. The same suggestion(s) will re-appear.\n      // By selecting the first one with the mouse, we need to retrigger a query because this means the search as you type could not\n      // kick in and do the query automatically.\n      if (this.lastQuery != this.getText()) {\n        this.triggerNewQuery(false, () => {\n          this.usageAnalytics.logSearchEvent<IAnalyticsOmniboxSuggestionMeta>(this.getOmniboxAnalyticsEventCause(), this.buildCustomDataForPartialQueries(index, suggestions));\n        });\n      }\n    }\n  }\n\n  private modifyCustomDataOnPending(index: number, suggestions: string[]) {\n    let pendingEvt = this.usageAnalytics.getPendingSearchEvent();\n    if (pendingEvt instanceof PendingSearchAsYouTypeSearchEvent) {\n      let newCustomData = this.buildCustomDataForPartialQueries(index, suggestions);\n      _.each(_.keys(newCustomData), (k: string) => {\n        (<PendingSearchAsYouTypeSearchEvent>pendingEvt).modifyCustomData(k, newCustomData[k]);\n      });\n    }\n  }\n\n  private buildCustomDataForPartialQueries(index: number, suggestions: string[]): IAnalyticsOmniboxSuggestionMeta {\n    return {\n      partialQueries: this.cleanCustomData(this.partialQueries),\n      suggestionRanking: index,\n      suggestions: this.cleanCustomData(suggestions),\n      partialQuery: _.last(this.partialQueries)\n    };\n  }\n\n  private cleanCustomData(toClean: string[], rejectLength = 256) {\n    // Filter out only consecutive values that are the identical\n    toClean = _.compact(_.filter(toClean, (partial: string, pos?: number, array?: string[]) => {\n      return pos === 0 || partial !== array[pos - 1];\n    }));\n\n    // Custom dimensions cannot be an array in analytics service: Send a string joined by ; instead.\n    // Need to replace ;\n    toClean = _.map(toClean, (partial) => {\n      return partial.replace(/;/g, '');\n    });\n\n    // Reduce right to get the last X words that adds to less then rejectLength\n    let reducedToRejectLengthOrLess = [];\n    _.reduceRight(toClean, (memo: number, partial: string) => {\n      let totalSoFar = memo + partial.length;\n      if (totalSoFar <= rejectLength) {\n        reducedToRejectLengthOrLess.push(partial);\n      }\n      return totalSoFar;\n    }, 0);\n    toClean = reducedToRejectLengthOrLess.reverse();\n    let ret = toClean.join(';');\n\n    // analytics service can store max 256 char in a custom event\n    // if we're over that, call cleanup again with an arbitrary 10 less char accepted\n    if (ret.length >= 256) {\n      return this.cleanCustomData(toClean, rejectLength - 10);\n    }\n\n    return toClean.join(';');\n  }\n\n  private handleSuggestions() {\n    let suggestionsEventArgs: IPopulateOmniboxSuggestionsEventArgs = {\n      suggestions: [],\n      omnibox: this\n    };\n    this.bind.trigger(this.element, OmniboxEvents.populateOmniboxSuggestions, suggestionsEventArgs);\n    let text = this.getText();\n    if (!Utils.isNullOrEmptyString(text)) {\n      this.partialQueries.push(text);\n    }\n    return _.compact(suggestionsEventArgs.suggestions);\n  }\n\n  private handleBeforeRedirect() {\n    this.updateQueryState();\n  }\n\n  private handleBuildingQuery(data: IBuildingQueryEventArgs) {\n    Assert.exists(data);\n    Assert.exists(data.queryBuilder);\n    this.updateQueryState();\n    this.lastQuery = this.getQuery(data.searchAsYouType);\n\n    let result: Coveo.MagicBox.Result = this.lastQuery == this.magicBox.getDisplayedResult().input ? this.magicBox.getDisplayedResult().clone() : this.magicBox.grammar.parse(this.lastQuery).clean();\n    let preprocessResultForQueryArgs: IOmniboxPreprocessResultForQueryEventArgs = {\n      result: result\n    };\n\n    if (this.options.enableQuerySyntax) {\n      let notQuotedValues = preprocessResultForQueryArgs.result.findAll('FieldValueNotQuoted');\n      _.each(notQuotedValues, (value: Coveo.MagicBox.Result) => value.value = '\"' + value.value.replace(/\"|\\u00A0/g, ' ') + '\"');\n      if (this.options.fieldAlias) {\n        let fieldNames = preprocessResultForQueryArgs.result.findAll((result: Coveo.MagicBox.Result) => result.expression.id == 'FieldName' && result.isSuccess());\n        _.each(fieldNames, (result: Coveo.MagicBox.Result) => {\n          let alias = _.find(_.keys(this.options.fieldAlias), (alias: string) => alias.toLowerCase() == result.value.toLowerCase());\n          if (alias != null) {\n            result.value = <string>this.options.fieldAlias[alias];\n          }\n        });\n      }\n    }\n\n    this.bind.trigger(this.element, OmniboxEvents.omniboxPreprocessResultForQuery, preprocessResultForQueryArgs);\n    let query = preprocessResultForQueryArgs.result.toString();\n    new QueryboxQueryParameters(this.options).addParameters(data.queryBuilder, query);\n  }\n\n  private handleTabPress() {\n    if (this.options.enableQuerySuggestAddon) {\n      this.handleTabPressForSuggestions();\n    } else {\n      this.handleTabPressForOldOmniboxAddon();\n    }\n  }\n\n  private handleTabPressForSuggestions() {\n    if (!this.options.enableSearchAsYouType) {\n      let suggestions = _.compact(_.map(this.lastSuggestions, (suggestion) => suggestion.text));\n      this.usageAnalytics.logCustomEvent(this.getOmniboxAnalyticsEventCause(), this.buildCustomDataForPartialQueries(0, suggestions), this.element);\n    }\n  }\n\n  private handleTabPressForOldOmniboxAddon() {\n    if (this.lastSuggestions && this.lastSuggestions[0] && this.lastSuggestions[0].dom) {\n      let firstSelected = $$(this.lastSuggestions[0].dom).find('.coveo-omnibox-selected');\n      let firstSelectable = $$(this.lastSuggestions[0].dom).find('.coveo-omnibox-selectable');\n      if (firstSelected) {\n        $$(firstSelected).trigger('tabSelect');\n      } else if (firstSelectable) {\n        $$(firstSelectable).trigger('tabSelect');\n      }\n    }\n  }\n\n  private triggerNewQuery(searchAsYouType: boolean, analyticsEvent: () => void) {\n    clearTimeout(this.searchAsYouTypeTimeout);\n    let text = this.getQuery(searchAsYouType);\n    if (this.shouldExecuteQuery(searchAsYouType)) {\n      this.lastQuery = text;\n      analyticsEvent();\n      this.queryController.executeQuery({\n        searchAsYouType: searchAsYouType,\n        logInActionsHistory: true\n      });\n    }\n  }\n\n  private getQuery(searchAsYouType: boolean) {\n    let query: string;\n    if (searchAsYouType) {\n      query = this.magicBox.getWordCompletion();\n      if (query == null && this.lastSuggestions != null && this.lastSuggestions.length > 0) {\n        let textSuggestion = _.find(this.lastSuggestions, (suggestion: IOmniboxSuggestion) => suggestion.text != null);\n        if (textSuggestion != null) {\n          query = textSuggestion.text;\n        }\n      }\n    }\n    return query || this.magicBox.getText();\n  }\n\n  public updateQueryState() {\n    this.queryStateModel.set(QueryStateModel.attributesEnum.q, this.magicBox.getText());\n  }\n\n  private handleQueryStateChanged(args: IAttributeChangedEventArg) {\n    Assert.exists(args);\n    let q = <string>args.value;\n    if (q != this.magicBox.getText()) {\n      this.magicBox.setText(q);\n    }\n  }\n\n  private handleQuerySuccess() {\n    if (!this.isAutoSuggestion()) {\n      this.partialQueries = [];\n    }\n  }\n\n  private handleDuringQuery(args: IDuringQueryEventArgs) {\n    // When the query results returns ... (args.promise)\n    args.promise.then(() => {\n      // Get a handle on a pending search as you type (those events are delayed, not sent instantly)\n      let pendingEvent = this.usageAnalytics.getPendingSearchEvent();\n      if (pendingEvent instanceof PendingSearchAsYouTypeSearchEvent) {\n        (<PendingSearchAsYouTypeSearchEvent>pendingEvent).beforeResolve.then((evt) => {\n          // Check if we need to modify the event type beforeResolving it\n          args.promise.then(() => {\n            if (this.modifyEventTo) {\n              evt.modifyEventCause(this.modifyEventTo);\n              this.modifyEventTo = null;\n            }\n          });\n        });\n      }\n    });\n  }\n\n  private searchAsYouType(forceExecuteQuery = false) {\n    this.clearSearchAsYouType();\n    if (this.shouldExecuteQuery(true)) {\n      this.searchAsYouTypeTimeout = setTimeout(() => {\n        if (this.suggestionShouldTriggerQuery() || forceExecuteQuery) {\n          let suggestions = _.map(this.lastSuggestions, (suggestion) => suggestion.text);\n          let index = _.indexOf(suggestions, this.magicBox.getWordCompletion());\n          this.triggerNewQuery(true, () => {\n            this.usageAnalytics.logSearchAsYouType<IAnalyticsOmniboxSuggestionMeta>(analyticsActionCauseList.searchboxAsYouType, this.buildCustomDataForPartialQueries(index, suggestions));\n          });\n          this.clearSearchAsYouType();\n        }\n\n      }, this.options.searchAsYouTypeDelay);\n    }\n  }\n\n  private isAutoSuggestion() {\n    return this.options.enableSearchAsYouType && this.options.enableQuerySuggestAddon;\n  }\n\n  private shouldExecuteQuery(searchAsYouType: boolean) {\n    let text = this.getQuery(searchAsYouType);\n    return this.lastQuery != text && text != null;\n  }\n\n  private suggestionShouldTriggerQuery(suggestions = this.lastSuggestions) {\n    if (this.shouldExecuteQuery(true)) {\n      if (suggestions && suggestions[0]) {\n        let suggestion = suggestions[0];\n        // If we have access to a confidence level, return true if we are equal or above the minimum confidence level.\n        if (suggestion && suggestion.executableConfidence != undefined) {\n          return suggestion.executableConfidence >= MINIMUM_EXECUTABLE_CONFIDENCE;\n        }\n        // If we don't have access to a confidence level, return true only if it \"starts with\" the content of the search box\n        if (suggestion.text && suggestion.text.indexOf(this.magicBox.getText()) == 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  private clearSearchAsYouType() {\n    clearTimeout(this.searchAsYouTypeTimeout);\n    this.searchAsYouTypeTimeout = undefined;\n  }\n\n  private getOmniboxAnalyticsEventCause() {\n    if (this.searchInterface instanceof StandaloneSearchInterface) {\n      return analyticsActionCauseList.omniboxFromLink;\n    }\n    return analyticsActionCauseList.omniboxAnalytics;\n  }\n}\n\nOmnibox.options = _.extend({}, Omnibox.options, Querybox.options);\nInitialization.registerAutoCreateComponent(Omnibox);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Omnibox/Omnibox.ts","import { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\nexport const MagicBox: any = require('exports-loader?Coveo.MagicBox!../../../node_modules/coveomagicbox/bin/MagicBox.min.js');\nimport { Initialization } from '../Base/Initialization';\nimport { Component } from '../Base/Component';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { ComponentOptions } from '../Base/ComponentOptions';\nimport { QueryEvents, IBuildingQueryEventArgs } from '../../events/QueryEvents';\nimport { MODEL_EVENTS, IAttributeChangedEventArg } from '../../models/Model';\nimport { QUERY_STATE_ATTRIBUTES, QueryStateModel } from '../../models/QueryStateModel';\nimport { StandaloneSearchInterfaceEvents } from '../../events/StandaloneSearchInterfaceEvents';\nimport { IAnalyticsNoMeta, analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\nimport { $$ } from '../../utils/Dom';\nimport { Assert } from '../../misc/Assert';\nimport { QueryboxQueryParameters } from './QueryboxQueryParameters';\nimport * as _ from 'underscore';\nimport { exportGlobally } from '../../GlobalExports';\n\nexport interface IQueryboxOptions {\n  enableSearchAsYouType?: boolean;\n  searchAsYouTypeDelay?: number;\n  enableQuerySyntax?: boolean;\n  enableWildcards?: boolean;\n  enableQuestionMarks?: boolean;\n  enableLowercaseOperators?: boolean;\n  enablePartialMatch?: boolean;\n  partialMatchKeywords?: number;\n  partialMatchThreshold?: string;\n  autoFocus?: boolean;\n  placeholder?: string;\n  triggerQueryOnClear?: boolean;\n}\n\n/**\n * The `Querybox` component renders an input which the end user can interact with to enter and submit queries.\n *\n * When the user submits a query, the `Querybox` component triggers a query and logs the corresponding usage analytics\n * data.\n *\n * For technical reasons, it is necessary to instantiate this component on a `div` element rather than on an `input`\n * element.\n *\n * See also the [`Searchbox`]{@link Searchbox} component, which can automatically instantiate a `Querybox` along with an\n * optional [`SearchButton`]{@link SearchButton} component.\n */\nexport class Querybox extends Component {\n  static ID = 'Querybox';\n\n  static doExport = () => {\n    exportGlobally({\n      'Querybox': Querybox,\n      'MagicBox': MagicBox\n    });\n  }\n\n  /**\n   * The options for the Querybox.\n   * @componentOptions\n   */\n  public static options: IQueryboxOptions = {\n\n    /**\n     * Specifies whether to enable the search-as-you-type feature.\n     *\n     * Default value is `false`.\n     */\n    enableSearchAsYouType: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * If the [`enableSearchAsYouType`]{@link Querybox.options.enableSearchAsYouType} option is `true`, specifies how\n     * long to wait (in milliseconds) between each key press before triggering a new query.\n     *\n     * Default value is `50`. Minimum value is `0`\n     */\n    searchAsYouTypeDelay: ComponentOptions.buildNumberOption({ defaultValue: 50, min: 0 }),\n\n    /**\n     * Specifies whether the Coveo Platform should try to interpret special query syntax (e.g., `@objecttype=message`)\n     * when the end user types a query in the `Querybox` (see\n     * [Coveo Query Syntax Reference](http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10005)). Enabling query\n     * syntax also causes the `Querybox` to highlight any query syntax.\n     *\n     * **Note:**\n     * > End user preferences can override the value you specify for this option.\n     * >\n     * > If the end user selects a value other than **Automatic** for the **Enable query syntax** setting (see\n     * > the [`enableQuerySyntax`]{@link ResultsPreferences.options.enableQuerySyntax} option of the\n     * > [`ResultsPreferences`]{@link ResultsPreferences} component), the end user preference takes precedence over this\n     * > option.\n     *\n     * Default value is `false`.\n     */\n    enableQuerySyntax: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the Coveo Platform should expand keywords containing wildcard characters (`*`) to the possible\n     * matching keywords in order to broaden the query (see\n     * [Coveo Query Syntax Reference](http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10005)).\n     *\n     * Default value is `false`.\n     */\n    enableWildcards: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the Coveo Platform should expand keywords containing question mark characters (`?`) to the\n     * possible matching keywords in order to broaden the query (see\n     * [Coveo Query Syntax Reference](http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10005)).\n     *\n     * Default value is `false`.\n     */\n    enableQuestionMarks: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * If the [`enableQuerySyntax`]{@link Querybox.options.enableQuerySyntax} option is `true`, specifies whether to\n     * treat the `AND`, `NOT`, `OR`, and `NEAR` keywords in the `Querybox` as query operators in the query, even if\n     * the end user types those keywords in lowercase.\n     *\n     * This option applies to all query operators (see\n     * [Coveo Query Syntax Reference](http://www.coveo.com/go?dest=adminhelp70&lcid=9&context=10005)).\n     *\n     * **Example:**\n     * > If this option and the `enableQuerySyntax` option are both `true`, the Coveo Platform interprets the `near`\n     * > keyword in a query such as `service center near me` as the `NEAR` query operator (not as a query term).\n     *\n     * > Otherwise, if the `enableQuerySyntax` option is `true` and this option is `false`, the end user has to type the\n     * > `NEAR` keyword in uppercase for the Coveo Platform to interpret it as a query operator.\n     *\n     * Default value is `false`.\n     */\n    enableLowercaseOperators: ComponentOptions.buildBooleanOption({ defaultValue: false, depend: 'enableQuerySyntax' }),\n\n    /**\n     * Specifies whether to automatically convert any basic expression containing at least a certain number of keywords\n     * (see the [`partialMatchKeywords`]{@link Querybox.options.partialMatchKeywords} option) to a *partial match\n     * expression*, so that items containing at least a certain subset of those keywords (see the\n     * [`partialMatchThreshold`]{@link Querybox.options.partialMatchThreshold} option) will match the query.\n     *\n     * **Example:**\n     *\n     * > With the following markup configuration, if a basic expression contains at least 4 keywords, items containing\n     * > at least 75% of those keywords (round up) will match the query.\n     * > ```html\n     * > <div class='CoveoQuerybox' data-enable-partial-match='true' data-partial-match-keywords='4' data-partial-match-threshold='75%'></div>\n     * > ```\n     * > For instance, if the basic expression is `Coveo custom component configuration help`, items containing\n     * > all 5 of those keywords, or 4 of them (75% of 5 rounded up) will match the query.\n     *\n     * Default value is `false`.\n     */\n    enablePartialMatch: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * When the [`enablePartialMatch`]{@link Querybox.options.enablePartialMatch} option is `true`, specifies the\n     * minimum number of keywords that need to be present in the basic expression to convert it to a partial match\n     * expression.\n     *\n     * See also the [`partialMatchThreshold`]{@link Querybox.options.partialMatchThreshold} option.\n     *\n     * **Note:**\n     * > Only the basic expression of the query (see [`q`]{@link q}) can be converted to a partial match expression.\n     *\n     * **Example:**\n     * > If the `partialMatchKeywords` value is `7`, the basic expression will have to contain at least 7 keywords\n     * > to be converted to a partial match expression.\n     *\n     * Default value is `5`.\n     */\n    partialMatchKeywords: ComponentOptions.buildNumberOption({ defaultValue: 5, min: 1 }),\n\n    /**\n     * When the [`enablePartialMatch`]{@link Querybox.options.enablePartialMatch} option is `true`, specifies an\n     * absolute or relative (percentage) value indicating the minimum number of partial match expression keywords an\n     * item must contain to match the query.\n     *\n     * See also the [`partialMatchKeywords`]{@link Querybox.options.partialMatchKeywords} option.\n     *\n     * **Note:**\n     * > The relative threshold is always rounded up to the nearest integer.\n     *\n     * **Examples:**\n     * > If the `partialMatchThreshold` value is `50%` and the partial match expression contains exactly 9 keywords,\n     * > items will have to contain at least 5 of those keywords to match the query (50% of 9, rounded up).\n     *\n     * > With the same configuration, if the partial match expression contains exactly 12 keywords, items will have to\n     * > contain at least 6 of those keywords to match the query (50% of 12).\n     *\n     * > If the `partialMatchThreshold` value is `2`, items will always have to contain at least 2 of the partial match\n     * > expression keywords to match the query, no matter how many keywords the partial match expression actually\n     * > contains.\n     *\n     * Default value is `50%`.\n     */\n    partialMatchThreshold: ComponentOptions.buildStringOption({ defaultValue: '50%' }),\n\n    /**\n     * Specifies whether to trigger a query when clearing the `Querybox`.\n     *\n     * Default value is `true`.\n     */\n    triggerQueryOnClear: ComponentOptions.buildBooleanOption({ defaultValue: true }),\n  };\n\n  public magicBox: Coveo.MagicBox.Instance;\n  private lastQuery: string;\n  private searchAsYouTypeTimeout: number;\n\n  /**\n   * Creates a new `Querybox component`. Creates a new `Coveo.Magicbox` instance and wraps the Magicbox methods\n   * (`onblur`, `onsubmit` etc.). Binds event on `buildingQuery` and before redirection (for standalone box).\n   * @param element The HTMLElement on which to instantiate the component. This cannot be an HTMLInputElement for\n   * technical reasons.\n   * @param options The options for the `Querybox` component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time).\n   */\n  constructor(public element: HTMLElement, public options?: IQueryboxOptions, public bindings?: IComponentBindings) {\n    super(element, Querybox.ID, bindings);\n\n    if (element instanceof HTMLInputElement) {\n      this.logger.error('Querybox cannot be used on an HTMLInputElement');\n    }\n\n    this.options = ComponentOptions.initComponentOptions(element, Querybox, options);\n    this.options = _.extend({}, this.options, this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.searchBox));\n\n    this.magicBox = MagicBox.create(element, new MagicBox.Grammar('Query', {\n      Query: '[Term*][Spaces?]',\n      Term: '[Spaces?][Word]',\n      Spaces: / +/,\n      Word: /[^ ]+/\n    }), {\n        inline: true\n      });\n\n    this.bind.onRootElement(QueryEvents.buildingQuery, (args: IBuildingQueryEventArgs) => this.handleBuildingQuery(args));\n    this.bind.onRootElement(StandaloneSearchInterfaceEvents.beforeRedirect, () => this.updateQueryState());\n    this.bind.onQueryState(MODEL_EVENTS.CHANGE_ONE, QUERY_STATE_ATTRIBUTES.Q, (args: IAttributeChangedEventArg) => this.handleQueryStateChanged(args));\n\n    if (this.options.enableSearchAsYouType) {\n      $$(this.element).addClass('coveo-search-as-you-type');\n      this.magicBox.onchange = () => {\n        this.searchAsYouType();\n      };\n    }\n\n    this.magicBox.onsubmit = () => {\n      this.submit();\n    };\n\n    this.magicBox.onblur = () => {\n      this.updateQueryState();\n    };\n\n    this.magicBox.onclear = () => {\n      this.updateQueryState();\n      if (this.options.triggerQueryOnClear) {\n        this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxClear, {});\n        this.triggerNewQuery(false);\n      }\n    };\n  }\n\n  /**\n   * Adds the current content of the input to the query and triggers a query if the current content of the input has\n   * changed since last submit.\n   *\n   * Also logs the `serachboxSubmit` event in the usage analytics.\n   */\n  public submit(): void {\n    this.magicBox.clearSuggestion();\n    this.updateQueryState();\n    this.usageAnalytics.logSearchEvent<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxSubmit, {});\n    this.triggerNewQuery(false);\n  }\n\n  /**\n   * Sets the content of the input.\n   *\n   * @param text The string to set in the input.\n   */\n  public setText(text: string): void {\n    this.magicBox.setText(text);\n    this.updateQueryState();\n  }\n\n  /**\n   * Clears the content of the input.\n   *\n   * See also the [`triggerQueryOnClear`]{@link Querybox.options.triggerQueryOnClear} option.\n   */\n  public clear(): void {\n    this.magicBox.clear();\n  }\n\n  /**\n   * Gets the content of the input.\n   *\n   * @returns {string} The content of the input.\n   */\n  public getText(): string {\n    return this.magicBox.getText();\n  }\n\n  /**\n   * Gets the result from the input.\n   *\n   * @returns {Result} The result.\n   */\n  public getResult() {\n    return this.magicBox.getResult();\n  }\n\n  /**\n   * Gets the displayed result from the input.\n   *\n   * @returns {Result} The displayed result.\n   */\n  public getDisplayedResult() {\n    return this.magicBox.getDisplayedResult();\n  }\n\n  /**\n   * Gets the current cursor position in the input.\n   *\n   * @returns {number} The cursor position (index starts at 0).\n   */\n  public getCursor(): number {\n    return this.magicBox.getCursor();\n  }\n\n  /**\n   * Gets the result at cursor position.\n   *\n   * @param match {string | { (result): boolean }} The match condition.\n   *\n   * @returns {Result[]} The result.\n   */\n  public resultAtCursor(match?: string | { (result): boolean; }) {\n    return this.magicBox.resultAtCursor(match);\n  }\n\n  private handleBuildingQuery(args: IBuildingQueryEventArgs): void {\n    Assert.exists(args);\n    Assert.exists(args.queryBuilder);\n\n    this.updateQueryState();\n    this.lastQuery = this.magicBox.getText();\n    new QueryboxQueryParameters(this.options).addParameters(args.queryBuilder, this.lastQuery);\n  }\n\n  private triggerNewQuery(searchAsYouType: boolean): void {\n    clearTimeout(this.searchAsYouTypeTimeout);\n    let text = this.magicBox.getText();\n    if (this.lastQuery != text && text != null) {\n      this.lastQuery = text;\n      this.queryController.executeQuery({\n        searchAsYouType: searchAsYouType,\n        logInActionsHistory: true\n      });\n    }\n  }\n\n  private updateQueryState(): void {\n    this.queryStateModel.set(QueryStateModel.attributesEnum.q, this.magicBox.getText());\n  }\n\n  private handleQueryStateChanged(args: IAttributeChangedEventArg): void {\n    Assert.exists(args);\n    let q = <string>args.value;\n    if (q != this.magicBox.getText()) {\n      this.magicBox.setText(q);\n    }\n  }\n\n  private searchAsYouType(): void {\n    clearTimeout(this.searchAsYouTypeTimeout);\n    this.searchAsYouTypeTimeout = setTimeout(() => {\n      this.usageAnalytics.logSearchAsYouType<IAnalyticsNoMeta>(analyticsActionCauseList.searchboxAsYouType, {});\n      this.triggerNewQuery(true);\n    }, this.options.searchAsYouTypeDelay);\n  }\n}\nInitialization.registerAutoCreateComponent(Querybox);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Querybox/Querybox.ts"],"sourceRoot":""}